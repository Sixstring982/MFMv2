<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>MFMv2: src/gui/include/AbstractGUIDriver.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">MFMv2
   
   </div>
   <div id="projectbrief">Movable Feast Machine Simulator v2</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">src/gui/include/AbstractGUIDriver.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="AbstractGUIDriver_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*                                              -*- mode:C++ -*-</span>
<a name="l00002"></a>00002 <span class="comment">  AbstractGUIDriver.h Base class for all GUI-based MFM drivers</span>
<a name="l00003"></a>00003 <span class="comment">  Copyright (C) 2014 The Regents of the University of New Mexico.  All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment">  This library is free software; you can redistribute it and/or</span>
<a name="l00006"></a>00006 <span class="comment">  modify it under the terms of the GNU Lesser General Public</span>
<a name="l00007"></a>00007 <span class="comment">  License as published by the Free Software Foundation; either</span>
<a name="l00008"></a>00008 <span class="comment">  version 2.1 of the License, or (at your option) any later version.</span>
<a name="l00009"></a>00009 <span class="comment"></span>
<a name="l00010"></a>00010 <span class="comment">  This library is distributed in the hope that it will be useful,</span>
<a name="l00011"></a>00011 <span class="comment">  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l00013"></a>00013 <span class="comment">  Lesser General Public License for more details.</span>
<a name="l00014"></a>00014 <span class="comment"></span>
<a name="l00015"></a>00015 <span class="comment">  You should have received a copy of the GNU General Public License</span>
<a name="l00016"></a>00016 <span class="comment">  along with this library; if not, write to the Free Software</span>
<a name="l00017"></a>00017 <span class="comment">  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301</span>
<a name="l00018"></a>00018 <span class="comment">  USA</span>
<a name="l00019"></a>00019 <span class="comment">*/</span>
<a name="l00020"></a>00020 
<a name="l00028"></a>00028 <span class="preprocessor">#ifndef ABSTRACTGUIDRIVER_H</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span><span class="preprocessor">#define ABSTRACTGUIDRIVER_H</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;sys/stat.h&gt;</span>  <span class="comment">/* for mkdir */</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;sys/types.h&gt;</span> <span class="comment">/* for mkdir */</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;errno.h&gt;</span>     <span class="comment">/* for errno */</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="Utils_8h.html">Utils.h</a>&quot;</span>     <span class="comment">/* for GetDateTimeNow */</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="Logger_8h.html">Logger.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="AssetManager_8h.html">AssetManager.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="AbstractButton_8h.html">AbstractButton.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="AbstractCheckbox_8h.html">AbstractCheckbox.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="AtomViewPanel_8h.html">AtomViewPanel.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="Tile_8h.html">Tile.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="GridRenderer_8h.html">GridRenderer.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="GridPanel_8h.html">GridPanel.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="TextPanel_8h.html">TextPanel.h</a>&quot;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="ToolboxPanel_8h.html">ToolboxPanel.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="TeeByteSink_8h.html">TeeByteSink.h</a>&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="StatsRenderer_8h.html">StatsRenderer.h</a>&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="Element__Empty_8h.html">Element_Empty.h</a>&quot;</span> <span class="comment">/* Need common elements */</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="Element__Dreg_8h.html">Element_Dreg.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="Element__Res_8h.html">Element_Res.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="Element__Wall_8h.html">Element_Wall.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="Element__Consumer_8h.html">Element_Consumer.h</a>&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="ExternalConfig_8h.html">ExternalConfig.h</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;FileByteSource.h&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &quot;<a class="code" href="Keyboard_8h.html">Keyboard.h</a>&quot;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="Camera_8h.html">Camera.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="AbstractDriver_8h.html">AbstractDriver.h</a>&quot;</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &quot;<a class="code" href="VArguments_8h.html">VArguments.h</a>&quot;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;SDL.h&quot;</span>
<a name="l00059"></a>00059 <span class="preprocessor">#include &quot;SDL_ttf.h&quot;</span>
<a name="l00060"></a>00060 <span class="preprocessor">#include &quot;<a class="code" href="HelpPanel_8h.html">HelpPanel.h</a>&quot;</span>
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="keyword">namespace </span>MFM
<a name="l00063"></a>00063 {
<a name="l00064"></a>00064 <span class="preprocessor">#define FRAMES_PER_SECOND 100.0</span>
<a name="l00065"></a>00065 <span class="preprocessor"></span>
<a name="l00066"></a>00066 <span class="preprocessor">#define CAMERA_SLOW_SPEED 2</span>
<a name="l00067"></a>00067 <span class="preprocessor"></span><span class="preprocessor">#define CAMERA_FAST_SPEED 50</span>
<a name="l00068"></a>00068 <span class="preprocessor"></span>
<a name="l00069"></a>00069 <span class="preprocessor">#define STATS_WINDOW_WIDTH 288</span>
<a name="l00070"></a>00070 <span class="preprocessor"></span>
<a name="l00071"></a>00071 <span class="preprocessor">#define STATS_START_WINDOW_WIDTH STATS_WINDOW_WIDTH  // Why two constants?</span>
<a name="l00072"></a>00072 <span class="preprocessor"></span><span class="preprocessor">#define STATS_START_WINDOW_HEIGHT 120</span>
<a name="l00073"></a>00073 <span class="preprocessor"></span>
<a name="l00074"></a>00074   <span class="comment">/* super speedy for now */</span>
<a name="l00075"></a>00075 <span class="preprocessor">#define MINIMAL_START_WINDOW_WIDTH 1</span>
<a name="l00076"></a>00076 <span class="preprocessor"></span><span class="preprocessor">#define MINIMAL_START_WINDOW_HEIGHT 1</span>
<a name="l00077"></a>00077 <span class="preprocessor"></span>
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 <span class="preprocessor">#define MAX_PATH_LENGTH 1000</span>
<a name="l00080"></a>00080 <span class="preprocessor"></span><span class="preprocessor">#define MIN_PATH_RESERVED_LENGTH 100</span>
<a name="l00081"></a>00081 <span class="preprocessor"></span>
<a name="l00082"></a>00082   <span class="keyword">template</span>&lt;<span class="keyword">class</span> GC&gt;
<a name="l00083"></a><a class="code" href="classMFM_1_1AbstractGUIDriver.html">00083</a>   <span class="keyword">class </span><a class="code" href="classMFM_1_1AbstractGUIDriver.html">AbstractGUIDriver</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1AbstractDriver.html">AbstractDriver</a>&lt;GC&gt;
<a name="l00084"></a>00084   {
<a name="l00085"></a>00085    <span class="keyword">private</span>:
<a name="l00086"></a>00086     <span class="keyword">typedef</span> <a class="code" href="classMFM_1_1AbstractDriver.html">AbstractDriver&lt;GC&gt;</a> <a class="code" href="classMFM_1_1AbstractDriver.html">Super</a>;
<a name="l00087"></a>00087 
<a name="l00088"></a>00088    <span class="keyword">protected</span>:
<a name="l00089"></a><a class="code" href="classMFM_1_1AbstractGUIDriver.html#aaaa07f2be399bd15e73d95d0aa64834e">00089</a>     <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classMFM_1_1Grid.html">Super::OurGrid</a> <a class="code" href="classMFM_1_1AbstractGUIDriver.html#aaaa07f2be399bd15e73d95d0aa64834e">OurGrid</a>;
<a name="l00090"></a><a class="code" href="classMFM_1_1AbstractGUIDriver.html#a55a2d45d813360afb1f2004d9b273c03">00090</a>     <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classMFM_1_1AbstractDriver.html#a3994f23e9f831c31af07781c23b439bc">Super::CC</a> <a class="code" href="classMFM_1_1AbstractGUIDriver.html#a55a2d45d813360afb1f2004d9b273c03">CC</a>;
<a name="l00091"></a>00091     <span class="keyword">enum</span> { W = GC::GRID_WIDTH};
<a name="l00092"></a>00092     <span class="keyword">enum</span> { H = GC::GRID_HEIGHT};
<a name="l00093"></a>00093 
<a name="l00094"></a>00094     <span class="keywordtype">bool</span> m_startPaused;
<a name="l00095"></a>00095     <span class="keywordtype">bool</span> m_thisUpdateIsEpoch;
<a name="l00096"></a>00096     <a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> m_thisEpochAEPS;
<a name="l00097"></a>00097     <span class="keywordtype">bool</span> m_captureScreenshots;
<a name="l00098"></a>00098     <a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> m_saveStateIndex;
<a name="l00099"></a>00099     <a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> m_epochSaveStateIndex;
<a name="l00100"></a>00100 
<a name="l00101"></a>00101     <span class="keywordtype">bool</span> m_keyboardPaused;   <span class="comment">// Toggled by keyboard space, &#39; &#39;, SDLK_SPACE</span>
<a name="l00102"></a>00102     <span class="keywordtype">bool</span> m_singleStep;       <span class="comment">// Toggled by Step check box, &#39;s&#39;, SDLK_SPACE</span>
<a name="l00103"></a>00103     <span class="keywordtype">bool</span> m_mousePaused;      <span class="comment">// Set if any buttons down, clear if all up</span>
<a name="l00104"></a>00104     <span class="keywordtype">bool</span> m_gridPaused;       <span class="comment">// Set if keyboard || mouse paused, checked by UpdateGrid</span>
<a name="l00105"></a>00105     <span class="keywordtype">bool</span> m_reinitRequested;
<a name="l00106"></a>00106     <span class="keywordtype">void</span> RequestReinit()
<a name="l00107"></a>00107     {
<a name="l00108"></a>00108       m_reinitRequested = <span class="keyword">true</span>;
<a name="l00109"></a>00109     }
<a name="l00110"></a>00110 
<a name="l00111"></a>00111     <span class="keywordtype">bool</span> m_renderStats;
<a name="l00112"></a>00112     <a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> m_ticksLastStopped;
<a name="l00113"></a>00113 
<a name="l00114"></a>00114     <span class="comment">//s32 m_recordScreenshotPerAEPS;</span>
<a name="l00115"></a>00115     <span class="comment">//s32 m_maxRecordScreenshotPerAEPS;</span>
<a name="l00116"></a>00116     <span class="comment">//s32 m_countOfScreenshotsAtThisAEPS;</span>
<a name="l00117"></a>00117     <span class="comment">//s32 m_countOfScreenshotsPerRate;</span>
<a name="l00118"></a>00118     <span class="comment">//u32 m_nextEventCountsAEPS;</span>
<a name="l00119"></a>00119     <span class="comment">//u32 m_nextScreenshotAEPS;</span>
<a name="l00120"></a>00120     <span class="comment">//u32 m_nextTimeBasedDataAEPS;</span>
<a name="l00121"></a>00121 
<a name="l00122"></a>00122     Keyboard m_keyboard;
<a name="l00123"></a>00123     Camera camera;
<a name="l00124"></a>00124     SDL_Surface* screen;
<a name="l00125"></a>00125     Panel m_rootPanel;
<a name="l00126"></a>00126     Drawing m_rootDrawing;
<a name="l00127"></a>00127 
<a name="l00128"></a>00128     <a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> m_screenWidth;
<a name="l00129"></a>00129     <a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> m_screenHeight;
<a name="l00130"></a>00130 
<a name="l00131"></a>00131 
<a name="l00132"></a>00132     <span class="comment">/************************************/</span>
<a name="l00133"></a>00133     <span class="comment">/*******ABSTRACT BUTTONS*************/</span>
<a name="l00134"></a>00134     <span class="comment">/************************************/</span>
<a name="l00135"></a>00135 
<a name="l00136"></a><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">00136</a>     <span class="keyword">class </span><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1AbstractButton.html">AbstractButton</a>
<a name="l00137"></a>00137     {
<a name="l00138"></a>00138      <span class="keyword">public</span>:
<a name="l00139"></a>00139       <span class="keywordtype">void</span> SetDriver(<a class="code" href="classMFM_1_1AbstractGUIDriver.html">AbstractGUIDriver</a> &amp; driver)
<a name="l00140"></a>00140       {
<a name="l00141"></a>00141         m_driver = &amp;driver;
<a name="l00142"></a>00142       }
<a name="l00143"></a>00143 
<a name="l00144"></a>00144       <span class="keywordtype">void</span> SetGridRenderer(<a class="code" href="classMFM_1_1GridRenderer.html">GridRenderer</a>&amp; grend)
<a name="l00145"></a>00145       {
<a name="l00146"></a>00146         m_grend = &amp;grend;
<a name="l00147"></a>00147       }
<a name="l00148"></a>00148 
<a name="l00149"></a>00149      <span class="keyword">protected</span>:
<a name="l00150"></a>00150       <a class="code" href="classMFM_1_1AbstractGUIDriver.html">AbstractGUIDriver</a> * m_driver;
<a name="l00151"></a>00151 
<a name="l00152"></a>00152       <a class="code" href="classMFM_1_1GridRenderer.html">GridRenderer</a>* m_grend;
<a name="l00153"></a>00153 
<a name="l00154"></a>00154       <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* title) :
<a name="l00155"></a>00155         <a class="code" href="classMFM_1_1AbstractButton.html#af0249cc4455bc3d8523c458c157ad75d">AbstractButton</a>(title), m_driver(0),
<a name="l00156"></a>00156         m_grend(NULL)
<a name="l00157"></a>00157       { }
<a name="l00158"></a>00158     };
<a name="l00159"></a>00159 
<a name="l00160"></a><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridCheckbox.html">00160</a>     <span class="keyword">class </span><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridCheckbox.html">AbstractGridCheckbox</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1AbstractCheckboxExternal.html">AbstractCheckboxExternal</a>
<a name="l00161"></a>00161     {
<a name="l00162"></a>00162      <span class="keyword">public</span>:
<a name="l00163"></a>00163       <span class="keywordtype">void</span> SetDriver(<a class="code" href="classMFM_1_1AbstractGUIDriver.html">AbstractGUIDriver</a> &amp; driver)
<a name="l00164"></a>00164       {
<a name="l00165"></a>00165         m_driver = &amp;driver;
<a name="l00166"></a>00166       }
<a name="l00167"></a>00167 
<a name="l00168"></a>00168      <span class="keyword">protected</span>:
<a name="l00169"></a>00169       <a class="code" href="classMFM_1_1AbstractGUIDriver.html">AbstractGUIDriver</a> * m_driver;
<a name="l00170"></a>00170 
<a name="l00171"></a>00171       <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridCheckbox.html">AbstractGridCheckbox</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* title) :
<a name="l00172"></a>00172         <a class="code" href="classMFM_1_1AbstractCheckboxExternal.html">AbstractCheckboxExternal</a>(title),
<a name="l00173"></a>00173         m_driver(0)
<a name="l00174"></a>00174       { }
<a name="l00175"></a>00175     };
<a name="l00176"></a>00176 
<a name="l00177"></a>00177     <span class="comment">/************************************/</span>
<a name="l00178"></a>00178     <span class="comment">/******CONCRETE BUTTONS**************/</span>
<a name="l00179"></a>00179     <span class="comment">/************************************/</span>
<a name="l00180"></a>00180 
<a name="l00181"></a>00181 
<a name="l00182"></a><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1ClearButton.html">00182</a>     <span class="keyword">class </span><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1ClearButton.html">ClearButton</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>
<a name="l00183"></a>00183     {
<a name="l00184"></a>00184      <span class="keyword">public</span>:
<a name="l00185"></a>00185       <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1ClearButton.html">ClearButton</a>() : <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>(<span class="stringliteral">&quot;Clear Tile&quot;</span>)
<a name="l00186"></a>00186       {
<a name="l00187"></a>00187         AbstractButton::SetName(<span class="stringliteral">&quot;ClearButton&quot;</span>);
<a name="l00188"></a>00188         <a class="code" href="classMFM_1_1AbstractButton.html#a00474ab1a7b0ed391121b502c3e976f4">Panel::SetDimensions</a>(200,40);
<a name="l00189"></a>00189         AbstractButton::SetRenderPoint(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(2, 250));
<a name="l00190"></a>00190       }
<a name="l00191"></a>00191 
<a name="l00192"></a><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1ClearButton.html#a36f52f0a7d13232473236a6106506ecd">00192</a>       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1ClearButton.html#a36f52f0a7d13232473236a6106506ecd">OnClick</a>(<a class="code" href="namespaceMFM.html#ab8c79d22c49af9b5b1f757ae5d436218">u8</a> button)
<a name="l00193"></a>00193       {
<a name="l00194"></a>00194         <a class="code" href="classMFM_1_1Grid.html">OurGrid</a> &amp; grid = AbstractGridButton::m_driver-&gt;GetGrid();
<a name="l00195"></a>00195         <a class="code" href="classMFM_1_1GridRenderer.html">GridRenderer</a> &amp; grend = AbstractGridButton::m_driver-&gt;GetGridRenderer();
<a name="l00196"></a>00196 
<a name="l00197"></a>00197         <span class="keyword">const</span> <a class="code" href="classMFM_1_1Point.html">SPoint</a> selTile = grend.GetSelectedTile();
<a name="l00198"></a>00198         <span class="keywordflow">if</span>(selTile.<a class="code" href="classMFM_1_1Point.html#a293a3d4c35e5cbaf6d7d3486a45287a8">GetX</a>() &gt;= 0 &amp;&amp; selTile.<a class="code" href="classMFM_1_1Point.html#a293a3d4c35e5cbaf6d7d3486a45287a8">GetX</a>() &lt; W &amp;&amp;
<a name="l00199"></a>00199            selTile.<a class="code" href="classMFM_1_1Point.html#a3dc1de7350cbd1e82da54c456aabb268">GetY</a>() &gt;= 0 &amp;&amp; selTile.<a class="code" href="classMFM_1_1Point.html#a3dc1de7350cbd1e82da54c456aabb268">GetY</a>() &lt; H)
<a name="l00200"></a>00200         {
<a name="l00201"></a>00201           grid.<a class="code" href="classMFM_1_1Grid.html#adfb13e123145f40ebff39f8ef39f95db">EmptyTile</a>(grend.GetSelectedTile());
<a name="l00202"></a>00202         }
<a name="l00203"></a>00203       }
<a name="l00204"></a>00204     } m_clearButton;
<a name="l00205"></a>00205 
<a name="l00206"></a><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1ClearGridButton.html">00206</a>     <span class="keyword">class </span><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1ClearGridButton.html">ClearGridButton</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>
<a name="l00207"></a>00207     {
<a name="l00208"></a>00208      <span class="keyword">public</span>:
<a name="l00209"></a>00209       <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1ClearGridButton.html">ClearGridButton</a>() : <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>(<span class="stringliteral">&quot;Clear Grid&quot;</span>)
<a name="l00210"></a>00210       {
<a name="l00211"></a>00211         AbstractButton::SetName(<span class="stringliteral">&quot;ClearGridButton&quot;</span>);
<a name="l00212"></a>00212         <a class="code" href="classMFM_1_1AbstractButton.html#a00474ab1a7b0ed391121b502c3e976f4">Panel::SetDimensions</a>(200,40);
<a name="l00213"></a>00213         AbstractButton::SetRenderPoint(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(2, 250));
<a name="l00214"></a>00214       }
<a name="l00215"></a>00215 
<a name="l00216"></a><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1ClearGridButton.html#a3607ed6713e7224ce9b7f0e08a13b0ed">00216</a>       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1ClearGridButton.html#a3607ed6713e7224ce9b7f0e08a13b0ed">OnClick</a>(<a class="code" href="namespaceMFM.html#ab8c79d22c49af9b5b1f757ae5d436218">u8</a> button)
<a name="l00217"></a>00217       {
<a name="l00218"></a>00218         <a class="code" href="classMFM_1_1Grid.html">OurGrid</a> &amp; grid = AbstractGridButton::m_driver-&gt;GetGrid();
<a name="l00219"></a>00219 
<a name="l00220"></a>00220         grid.<a class="code" href="classMFM_1_1Grid.html#a6b2b7c0eec66863da6f159524682dd23">Clear</a>();
<a name="l00221"></a>00221       }
<a name="l00222"></a>00222     } m_clearGridButton;
<a name="l00223"></a>00223 
<a name="l00224"></a><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1NukeButton.html">00224</a>     <span class="keyword">class </span><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1NukeButton.html">NukeButton</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>
<a name="l00225"></a>00225     {
<a name="l00226"></a>00226      <span class="keyword">public</span>:
<a name="l00227"></a>00227       <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1NukeButton.html">NukeButton</a>() : <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>(<span class="stringliteral">&quot;Nuke&quot;</span>)
<a name="l00228"></a>00228       {
<a name="l00229"></a>00229         AbstractButton::SetName(<span class="stringliteral">&quot;NukeButton&quot;</span>);
<a name="l00230"></a>00230         <a class="code" href="classMFM_1_1AbstractButton.html#a00474ab1a7b0ed391121b502c3e976f4">Panel::SetDimensions</a>(200,40);
<a name="l00231"></a>00231         AbstractButton::SetRenderPoint(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(2, 100));
<a name="l00232"></a>00232       }
<a name="l00233"></a>00233 
<a name="l00234"></a><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1NukeButton.html#abdd8237eb9749eb3206f5d16c6a9a311">00234</a>       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1NukeButton.html#abdd8237eb9749eb3206f5d16c6a9a311">OnClick</a>(<a class="code" href="namespaceMFM.html#ab8c79d22c49af9b5b1f757ae5d436218">u8</a> button)
<a name="l00235"></a>00235       {
<a name="l00236"></a>00236         AbstractGridButton::m_driver-&gt;GetGrid().RandomNuke();
<a name="l00237"></a>00237       }
<a name="l00238"></a>00238     } m_nukeButton;
<a name="l00239"></a>00239 
<a name="l00240"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1XRayButton.html">00240</a>     <span class="keyword">struct </span><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1XRayButton.html">XRayButton</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>
<a name="l00241"></a>00241     {
<a name="l00242"></a>00242       <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1XRayButton.html">XRayButton</a>() : <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>(<span class="stringliteral">&quot;XRay&quot;</span>)
<a name="l00243"></a>00243       {
<a name="l00244"></a>00244         AbstractButton::SetName(<span class="stringliteral">&quot;XRayButton&quot;</span>);
<a name="l00245"></a>00245         <a class="code" href="classMFM_1_1AbstractButton.html#a00474ab1a7b0ed391121b502c3e976f4">Panel::SetDimensions</a>(200,40);
<a name="l00246"></a>00246         AbstractButton::SetRenderPoint(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(2, 150));
<a name="l00247"></a>00247       }
<a name="l00248"></a>00248 
<a name="l00249"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1XRayButton.html#a68c8a03029afef301262541d2a2efe24">00249</a>       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1XRayButton.html#a68c8a03029afef301262541d2a2efe24">OnClick</a>(<a class="code" href="namespaceMFM.html#ab8c79d22c49af9b5b1f757ae5d436218">u8</a> button)
<a name="l00250"></a>00250       {
<a name="l00251"></a>00251         AbstractGridButton::m_driver-&gt;GetGrid().XRay();
<a name="l00252"></a>00252       }
<a name="l00253"></a>00253     } m_xrayButton;
<a name="l00254"></a>00254 
<a name="l00255"></a><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1GridRunCheckbox.html">00255</a>     <span class="keyword">class </span><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1GridRunCheckbox.html">GridRunCheckbox</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridCheckbox.html">AbstractGridCheckbox</a>
<a name="l00256"></a>00256     {
<a name="l00257"></a>00257      <span class="keyword">public</span>:
<a name="l00258"></a>00258       <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1GridRunCheckbox.html">GridRunCheckbox</a>() : <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridCheckbox.html">AbstractGridCheckbox</a>(<span class="stringliteral">&quot;Pause&quot;</span>)
<a name="l00259"></a>00259       {
<a name="l00260"></a>00260         AbstractButton::SetName(<span class="stringliteral">&quot;GridRunButton&quot;</span>);
<a name="l00261"></a>00261         <a class="code" href="classMFM_1_1AbstractButton.html#a00474ab1a7b0ed391121b502c3e976f4">Panel::SetDimensions</a>(200, 25);
<a name="l00262"></a>00262         AbstractButton::SetRenderPoint(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(2, 0));
<a name="l00263"></a>00263       }
<a name="l00264"></a>00264 
<a name="l00265"></a><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1GridRunCheckbox.html#afab742df27e96ed2f406f958aeb66278">00265</a>       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1GridRunCheckbox.html#afab742df27e96ed2f406f958aeb66278">OnCheck</a>(<span class="keywordtype">bool</span> value)
<a name="l00266"></a>00266       { }
<a name="l00267"></a>00267     }m_gridRunButton;
<a name="l00268"></a>00268 
<a name="l00269"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1GridRenderButton.html">00269</a>     <span class="keyword">struct </span><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1GridRenderButton.html">GridRenderButton</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridCheckbox.html">AbstractGridCheckbox</a>
<a name="l00270"></a>00270     {
<a name="l00271"></a>00271       <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1GridRenderButton.html">GridRenderButton</a>() : <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridCheckbox.html">AbstractGridCheckbox</a>(<span class="stringliteral">&quot;Grid&quot;</span>)
<a name="l00272"></a>00272       {
<a name="l00273"></a>00273         AbstractButton::SetName(<span class="stringliteral">&quot;GridRenderButton&quot;</span>);
<a name="l00274"></a>00274         <a class="code" href="classMFM_1_1AbstractButton.html#a00474ab1a7b0ed391121b502c3e976f4">Panel::SetDimensions</a>(200,25);
<a name="l00275"></a>00275         AbstractButton::SetRenderPoint(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(2, 25));
<a name="l00276"></a>00276       }
<a name="l00277"></a>00277 
<a name="l00278"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1GridRenderButton.html#ae2844f3bbe8efce1e5129661f63e4df1">00278</a>       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1GridRenderButton.html#ae2844f3bbe8efce1e5129661f63e4df1">OnCheck</a>(<span class="keywordtype">bool</span> value)
<a name="l00279"></a>00279       { }
<a name="l00280"></a>00280     } m_gridRenderButton;
<a name="l00281"></a>00281 
<a name="l00282"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1HeatmapButton.html">00282</a>     <span class="keyword">struct </span><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1HeatmapButton.html">HeatmapButton</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridCheckbox.html">AbstractGridCheckbox</a>
<a name="l00283"></a>00283     {
<a name="l00284"></a>00284       <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1HeatmapButton.html">HeatmapButton</a>() : <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridCheckbox.html">AbstractGridCheckbox</a>(<span class="stringliteral">&quot;Heatmap&quot;</span>)
<a name="l00285"></a>00285       {
<a name="l00286"></a>00286         AbstractButton::SetName(<span class="stringliteral">&quot;HeatmapButton&quot;</span>);
<a name="l00287"></a>00287         <a class="code" href="classMFM_1_1AbstractButton.html#a00474ab1a7b0ed391121b502c3e976f4">Panel::SetDimensions</a>(200,25);
<a name="l00288"></a>00288         AbstractButton::SetRenderPoint(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(2, 50));
<a name="l00289"></a>00289       }
<a name="l00290"></a>00290 
<a name="l00291"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1HeatmapButton.html#afaefe3140d89f753f26325398a936dbd">00291</a>       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1HeatmapButton.html#afaefe3140d89f753f26325398a936dbd">OnCheck</a>(<span class="keywordtype">bool</span> value)
<a name="l00292"></a>00292       { }
<a name="l00293"></a>00293     } m_heatmapButton;
<a name="l00294"></a>00294 
<a name="l00295"></a><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1GridStepCheckbox.html">00295</a>     <span class="keyword">class </span><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1GridStepCheckbox.html">GridStepCheckbox</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>
<a name="l00296"></a>00296     {
<a name="l00297"></a>00297      <span class="keyword">public</span>:
<a name="l00298"></a>00298       <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1GridStepCheckbox.html">GridStepCheckbox</a>() : <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>(<span class="stringliteral">&quot;Step&quot;</span>)
<a name="l00299"></a>00299       {
<a name="l00300"></a>00300         AbstractButton::SetName(<span class="stringliteral">&quot;GridStepButton&quot;</span>);
<a name="l00301"></a>00301         <a class="code" href="classMFM_1_1AbstractButton.html#a00474ab1a7b0ed391121b502c3e976f4">Panel::SetDimensions</a>(200, 40);
<a name="l00302"></a>00302         AbstractButton::SetRenderPoint(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(2, 200));
<a name="l00303"></a>00303       }
<a name="l00304"></a>00304 
<a name="l00305"></a><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1GridStepCheckbox.html#a7e69518b44991c8c309c86b50dca98d3">00305</a>       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1GridStepCheckbox.html#a7e69518b44991c8c309c86b50dca98d3">OnClick</a>(<a class="code" href="namespaceMFM.html#ab8c79d22c49af9b5b1f757ae5d436218">u8</a> button)
<a name="l00306"></a>00306       {
<a name="l00307"></a>00307         AbstractGridButton::m_driver-&gt;m_singleStep = <span class="keyword">true</span>;
<a name="l00308"></a>00308         AbstractGridButton::m_driver-&gt;m_keyboardPaused = <span class="keyword">false</span>;
<a name="l00309"></a>00309       }
<a name="l00310"></a>00310     }m_gridStepButton;
<a name="l00311"></a>00311 
<a name="l00312"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1TileViewButton.html">00312</a>     <span class="keyword">struct </span><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1TileViewButton.html">TileViewButton</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>
<a name="l00313"></a>00313     {
<a name="l00314"></a>00314       <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1TileViewButton.html">TileViewButton</a>() : <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>(<span class="stringliteral">&quot;Change Tile View&quot;</span>)
<a name="l00315"></a>00315       {
<a name="l00316"></a>00316         AbstractButton::SetName(<span class="stringliteral">&quot;TileViewButton&quot;</span>);
<a name="l00317"></a>00317         <a class="code" href="classMFM_1_1AbstractButton.html#a00474ab1a7b0ed391121b502c3e976f4">Panel::SetDimensions</a>(200,40);
<a name="l00318"></a>00318         AbstractButton::SetRenderPoint(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(2, 200));
<a name="l00319"></a>00319       }
<a name="l00320"></a>00320 
<a name="l00321"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1TileViewButton.html#a5b46f320f5d830b48985aa09dc1f1aee">00321</a>       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1TileViewButton.html#a5b46f320f5d830b48985aa09dc1f1aee">OnClick</a>(<a class="code" href="namespaceMFM.html#ab8c79d22c49af9b5b1f757ae5d436218">u8</a> button)
<a name="l00322"></a>00322       {
<a name="l00323"></a>00323         AbstractGridButton::m_driver-&gt;GetGridRenderer().ToggleMemDraw();
<a name="l00324"></a>00324       }
<a name="l00325"></a>00325     } m_tileViewButton;
<a name="l00326"></a>00326 
<a name="l00327"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1SaveButton.html">00327</a>     <span class="keyword">struct </span><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1SaveButton.html">SaveButton</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>
<a name="l00328"></a>00328     {
<a name="l00329"></a>00329       <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1SaveButton.html">SaveButton</a>() : <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>(<span class="stringliteral">&quot;Save State&quot;</span>)
<a name="l00330"></a>00330       {
<a name="l00331"></a>00331         AbstractButton::SetName(<span class="stringliteral">&quot;SaveButton&quot;</span>);
<a name="l00332"></a>00332         <a class="code" href="classMFM_1_1AbstractButton.html#a00474ab1a7b0ed391121b502c3e976f4">Panel::SetDimensions</a>(200, 40);
<a name="l00333"></a>00333         AbstractButton::SetRenderPoint(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(2, 300));
<a name="l00334"></a>00334       }
<a name="l00335"></a>00335 
<a name="l00336"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1SaveButton.html#af2e8d51ef6cf4e069bdf173486dcdf42">00336</a>       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1SaveButton.html#af2e8d51ef6cf4e069bdf173486dcdf42">OnClick</a>(<a class="code" href="namespaceMFM.html#ab8c79d22c49af9b5b1f757ae5d436218">u8</a> button)
<a name="l00337"></a>00337       {
<a name="l00338"></a>00338         AbstractGridButton::m_driver-&gt;SaveGridWithNextFilename();
<a name="l00339"></a>00339       }
<a name="l00340"></a>00340 
<a name="l00341"></a>00341     <span class="keyword">private</span>:
<a name="l00342"></a>00342 
<a name="l00343"></a>00343     }m_saveButton;
<a name="l00344"></a>00344 
<a name="l00345"></a><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1ScreenshotButton.html">00345</a>     <span class="keyword">class </span><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1ScreenshotButton.html">ScreenshotButton</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>
<a name="l00346"></a>00346     {
<a name="l00347"></a>00347      <span class="keyword">private</span>:
<a name="l00348"></a>00348       <a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> m_currentScreenshot;
<a name="l00349"></a>00349       SDL_Surface* m_screen;
<a name="l00350"></a>00350       <a class="code" href="classMFM_1_1Camera.html">Camera</a>* m_camera;
<a name="l00351"></a>00351       <a class="code" href="classMFM_1_1AbstractDriver.html">AbstractDriver&lt;GC&gt;</a>* m_driver;
<a name="l00352"></a>00352 
<a name="l00353"></a>00353      <span class="keyword">public</span>:
<a name="l00354"></a>00354       <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1ScreenshotButton.html">ScreenshotButton</a>() :
<a name="l00355"></a>00355         <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>(<span class="stringliteral">&quot;Screenshot&quot;</span>),
<a name="l00356"></a>00356         m_currentScreenshot(0),
<a name="l00357"></a>00357         m_screen(NULL),
<a name="l00358"></a>00358         m_camera(NULL)
<a name="l00359"></a>00359       {
<a name="l00360"></a>00360         AbstractButton::SetName(<span class="stringliteral">&quot;Screenshot&quot;</span>);
<a name="l00361"></a>00361         <a class="code" href="classMFM_1_1AbstractButton.html#a00474ab1a7b0ed391121b502c3e976f4">Panel::SetDimensions</a>(200, 40);
<a name="l00362"></a>00362       }
<a name="l00363"></a>00363 
<a name="l00364"></a>00364       <span class="keywordtype">void</span> SetScreen(SDL_Surface* screen)
<a name="l00365"></a>00365       {
<a name="l00366"></a>00366         m_screen = screen;
<a name="l00367"></a>00367       }
<a name="l00368"></a>00368 
<a name="l00369"></a>00369       <span class="keywordtype">void</span> SetCamera(<a class="code" href="classMFM_1_1Camera.html">Camera</a>* camera)
<a name="l00370"></a>00370       {
<a name="l00371"></a>00371         m_camera = camera;
<a name="l00372"></a>00372       }
<a name="l00373"></a>00373 
<a name="l00374"></a>00374       <span class="keywordtype">void</span> SetDriver(<a class="code" href="classMFM_1_1AbstractDriver.html">AbstractDriver&lt;GC&gt;</a>* driver)
<a name="l00375"></a>00375       {
<a name="l00376"></a>00376         m_driver = driver;
<a name="l00377"></a>00377       }
<a name="l00378"></a>00378 
<a name="l00379"></a><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1ScreenshotButton.html#ab07561e651052c81d69c9d95785b7d2f">00379</a>       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1ScreenshotButton.html#ab07561e651052c81d69c9d95785b7d2f">OnClick</a>(<a class="code" href="namespaceMFM.html#ab8c79d22c49af9b5b1f757ae5d436218">u8</a> button)
<a name="l00380"></a>00380       {
<a name="l00381"></a>00381         <span class="keywordflow">if</span>(m_driver &amp;&amp; m_screen &amp;&amp; m_camera)
<a name="l00382"></a>00382         {
<a name="l00383"></a>00383           <span class="keyword">const</span> <span class="keywordtype">char</span> * path = m_driver-&gt;GetSimDirPathTemporary(<span class="stringliteral">&quot;screenshot/%010d.png&quot;</span>,
<a name="l00384"></a>00384                                                                ++m_currentScreenshot);
<a name="l00385"></a>00385           LOG.<a class="code" href="classMFM_1_1Logger.html#a7137c6959d0e7bfe05d4f48db9e5e311">Debug</a>(<span class="stringliteral">&quot;Screenshot saved at %s&quot;</span>, path);
<a name="l00386"></a>00386 
<a name="l00387"></a>00387           m_camera-&gt;DrawSurface(m_screen, path);
<a name="l00388"></a>00388         }
<a name="l00389"></a>00389         <span class="keywordflow">else</span>
<a name="l00390"></a>00390         {
<a name="l00391"></a>00391           LOG.<a class="code" href="classMFM_1_1Logger.html#a7137c6959d0e7bfe05d4f48db9e5e311">Debug</a>(<span class="stringliteral">&quot;Screenshot not saved; screen is null. Use SetScreen() first.&quot;</span>);
<a name="l00392"></a>00392         }
<a name="l00393"></a>00393       }
<a name="l00394"></a>00394     }m_screenshotButton;
<a name="l00395"></a>00395 
<a name="l00396"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1QuitButton.html">00396</a>     <span class="keyword">struct </span><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1QuitButton.html">QuitButton</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>
<a name="l00397"></a>00397     {
<a name="l00398"></a>00398       <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1QuitButton.html">QuitButton</a>() : <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>(<span class="stringliteral">&quot;Quit&quot;</span>)
<a name="l00399"></a>00399       {
<a name="l00400"></a>00400         AbstractButton::SetName(<span class="stringliteral">&quot;QuitButton&quot;</span>);
<a name="l00401"></a>00401         <a class="code" href="classMFM_1_1AbstractButton.html#a00474ab1a7b0ed391121b502c3e976f4">Panel::SetDimensions</a>(200,40);
<a name="l00402"></a>00402         AbstractButton::SetRenderPoint(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(2, 350));
<a name="l00403"></a>00403       }
<a name="l00404"></a>00404 
<a name="l00405"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1QuitButton.html#a6a4b07b742ed19526fa39d203181ac71">00405</a>       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1QuitButton.html#a6a4b07b742ed19526fa39d203181ac71">OnClick</a>(<a class="code" href="namespaceMFM.html#ab8c79d22c49af9b5b1f757ae5d436218">u8</a> button)
<a name="l00406"></a>00406       {
<a name="l00407"></a>00407         exit(0);
<a name="l00408"></a>00408       }
<a name="l00409"></a>00409     } m_quitButton;
<a name="l00410"></a>00410 
<a name="l00411"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1ReloadButton.html">00411</a>     <span class="keyword">struct </span><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1ReloadButton.html">ReloadButton</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>
<a name="l00412"></a>00412     {
<a name="l00413"></a>00413       <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1ReloadButton.html">ReloadButton</a>() : <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>(<span class="stringliteral">&quot;Reload&quot;</span>)
<a name="l00414"></a>00414       {
<a name="l00415"></a>00415         AbstractButton::SetName(<span class="stringliteral">&quot;ReloadButton&quot;</span>);
<a name="l00416"></a>00416         <a class="code" href="classMFM_1_1AbstractButton.html#a00474ab1a7b0ed391121b502c3e976f4">Panel::SetDimensions</a>(200,40);
<a name="l00417"></a>00417         AbstractButton::SetRenderPoint(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(2, 350));
<a name="l00418"></a>00418       }
<a name="l00419"></a>00419 
<a name="l00420"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1ReloadButton.html#ac2c896a1255dc25771718584e82afb0f">00420</a>       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1ReloadButton.html#ac2c896a1255dc25771718584e82afb0f">OnClick</a>(<a class="code" href="namespaceMFM.html#ab8c79d22c49af9b5b1f757ae5d436218">u8</a> button)
<a name="l00421"></a>00421       {
<a name="l00422"></a>00422         AbstractGridButton::m_driver-&gt;LoadFromConfigurationPath();
<a name="l00423"></a>00423       }
<a name="l00424"></a>00424     } m_reloadButton;
<a name="l00425"></a>00425 
<a name="l00426"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1PauseTileButton.html">00426</a>     <span class="keyword">struct </span><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1PauseTileButton.html">PauseTileButton</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>
<a name="l00427"></a>00427     {
<a name="l00428"></a>00428       <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1PauseTileButton.html">PauseTileButton</a>() : <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridButton.html">AbstractGridButton</a>(<span class="stringliteral">&quot;Pause Tile&quot;</span>)
<a name="l00429"></a>00429       {
<a name="l00430"></a>00430         AbstractButton::SetName(<span class="stringliteral">&quot;PauseTileButton&quot;</span>);
<a name="l00431"></a>00431         <a class="code" href="classMFM_1_1AbstractButton.html#a00474ab1a7b0ed391121b502c3e976f4">Panel::SetDimensions</a>(200, 40);
<a name="l00432"></a>00432         AbstractButton::SetRenderPoint(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(2, 400));
<a name="l00433"></a>00433       }
<a name="l00434"></a>00434 
<a name="l00435"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1PauseTileButton.html#a0355bf746ad2e8a96a13946c2f208ded">00435</a>       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1PauseTileButton.html#a0355bf746ad2e8a96a13946c2f208ded">OnClick</a>(<a class="code" href="namespaceMFM.html#ab8c79d22c49af9b5b1f757ae5d436218">u8</a> button)
<a name="l00436"></a>00436       {
<a name="l00437"></a>00437         <a class="code" href="classMFM_1_1Point.html">SPoint</a> selectedTile = AbstractGridButton::m_grend-&gt;GetSelectedTile();
<a name="l00438"></a>00438 
<a name="l00439"></a>00439         <span class="keywordflow">if</span>(selectedTile.<a class="code" href="classMFM_1_1Point.html#a293a3d4c35e5cbaf6d7d3486a45287a8">GetX</a>() &gt;= 0 &amp;&amp; selectedTile.<a class="code" href="classMFM_1_1Point.html#a3dc1de7350cbd1e82da54c456aabb268">GetY</a>() &gt;= 0)
<a name="l00440"></a>00440         {
<a name="l00441"></a>00441           AbstractGridButton::m_driver-&gt;GetGrid().SetTileToExecuteOnly(
<a name="l00442"></a>00442             selectedTile,
<a name="l00443"></a>00443             !AbstractGridButton::m_driver-&gt;GetGrid().GetTileExecutionStatus(selectedTile));
<a name="l00444"></a>00444         }
<a name="l00445"></a>00445 
<a name="l00446"></a>00446       }
<a name="l00447"></a>00447     }m_pauseTileButton;
<a name="l00448"></a>00448 
<a name="l00449"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1BGRButton.html">00449</a>     <span class="keyword">struct </span><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1BGRButton.html">BGRButton</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridCheckbox.html">AbstractGridCheckbox</a>
<a name="l00450"></a>00450     {
<a name="l00451"></a>00451       <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1BGRButton.html">BGRButton</a>() : <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1AbstractGridCheckbox.html">AbstractGridCheckbox</a>(<span class="stringliteral">&quot;Writes fault&quot;</span>)
<a name="l00452"></a>00452       {
<a name="l00453"></a>00453         AbstractButton::SetName(<span class="stringliteral">&quot;BGRButton&quot;</span>);
<a name="l00454"></a>00454         <a class="code" href="classMFM_1_1AbstractButton.html#a00474ab1a7b0ed391121b502c3e976f4">Panel::SetDimensions</a>(200,25);
<a name="l00455"></a>00455         AbstractButton::SetRenderPoint(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(2, 75));
<a name="l00456"></a>00456         Panel::SetVisibility(<span class="keyword">true</span>);
<a name="l00457"></a>00457       }
<a name="l00458"></a>00458 
<a name="l00459"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1BGRButton.html#a20a1eb970f0589417cc48132ccc6eebd">00459</a>       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1BGRButton.html#a20a1eb970f0589417cc48132ccc6eebd">OnCheck</a>(<span class="keywordtype">bool</span> value)
<a name="l00460"></a>00460       {
<a name="l00461"></a>00461         AbstractGridCheckbox::m_driver-&gt;GetGrid().SetBackgroundRadiation(
<a name="l00462"></a>00462           this-&gt;<a class="code" href="classMFM_1_1AbstractCheckboxExternal.html#aa349a155123b0f41ebfb6338f3e5f4b5">IsChecked</a>());
<a name="l00463"></a>00463       }
<a name="l00464"></a>00464     } m_bgrButton;
<a name="l00465"></a>00465 
<a name="l00466"></a>00466     <a class="code" href="classMFM_1_1HelpPanel.html">HelpPanel</a> m_helpPanel;
<a name="l00467"></a>00467 
<a name="l00468"></a>00468   <span class="keyword">protected</span>: <span class="comment">/* Need these for our buttons at driver level */</span>
<a name="l00469"></a>00469     <a class="code" href="classMFM_1_1GridRenderer.html">GridRenderer</a> m_grend;
<a name="l00470"></a>00470     <a class="code" href="classMFM_1_1StatsRenderer.html">StatsRenderer&lt;GC&gt;</a> m_srend;
<a name="l00471"></a>00471 
<a name="l00472"></a>00472     <a class="code" href="classMFM_1_1GridRenderer.html">GridRenderer</a> &amp; GetGridRenderer()
<a name="l00473"></a>00473     {
<a name="l00474"></a>00474       <span class="keywordflow">return</span> m_grend;
<a name="l00475"></a>00475     }
<a name="l00476"></a>00476 
<a name="l00477"></a><a class="code" href="classMFM_1_1AbstractGUIDriver.html#a8f7481ea14c572b5203d9ce9373d19d2">00477</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMFM_1_1AbstractGUIDriver.html#a8f7481ea14c572b5203d9ce9373d19d2">PostUpdate</a>()
<a name="l00478"></a>00478     {
<a name="l00479"></a>00479       <span class="comment">/* Update the stats renderer */</span>
<a name="l00480"></a>00480       m_statisticsPanel.SetAEPS(Super::GetAEPS());
<a name="l00481"></a>00481       m_statisticsPanel.SetAER(Super::GetRecentAER());  <span class="comment">// Use backwards averaged value</span>
<a name="l00482"></a>00482       m_statisticsPanel.SetAEPSPerFrame(Super::GetAEPSPerFrame());
<a name="l00483"></a>00483       m_statisticsPanel.SetOverheadPercent(Super::GetOverheadPercent());
<a name="l00484"></a>00484     }
<a name="l00485"></a>00485 
<a name="l00486"></a><a class="code" href="classMFM_1_1AbstractGUIDriver.html#adb86c947be24749b2731a2ad1ae8ff4e">00486</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMFM_1_1AbstractGUIDriver.html#adb86c947be24749b2731a2ad1ae8ff4e">DoEpochEvents</a>(<a class="code" href="classMFM_1_1Grid.html">OurGrid</a>&amp; grid, <a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> epochs, <a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> epochAEPS)
<a name="l00487"></a>00487     {
<a name="l00488"></a>00488       <a class="code" href="classMFM_1_1AbstractDriver.html#a01674d3727569eecae07116fd4e35ca4">Super::DoEpochEvents</a>(grid, epochs, epochAEPS);
<a name="l00489"></a>00489       m_thisUpdateIsEpoch = <span class="keyword">true</span>;
<a name="l00490"></a>00490       m_thisEpochAEPS = epochAEPS;
<a name="l00491"></a>00491     }
<a name="l00492"></a>00492 
<a name="l00493"></a><a class="code" href="classMFM_1_1AbstractGUIDriver.html#ae503e1cd6d053efe850aeb48f68005f1">00493</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMFM_1_1AbstractGUIDriver.html#ae503e1cd6d053efe850aeb48f68005f1">OnceOnly</a>(<a class="code" href="classMFM_1_1VArguments.html">VArguments</a>&amp; args)
<a name="l00494"></a>00494     {
<a name="l00496"></a>00496       {
<a name="l00497"></a>00497 
<a name="l00498"></a>00498         <a class="code" href="classMFM_1_1ByteSink.html">ByteSink</a> * old = LOG.<a class="code" href="classMFM_1_1Logger.html#a12113b75b13882a489c2b58322111565">SetByteSink</a>(m_logSplitter);
<a name="l00499"></a>00499         m_logSplitter.<a class="code" href="classMFM_1_1TeeByteSink.html#a9d612c595468a36a56feba1d1cb39a4a">SetSink1</a>(old);
<a name="l00500"></a>00500         m_logSplitter.<a class="code" href="classMFM_1_1TeeByteSink.html#a0b861bb2bea316a90156dc4dc9e6d0d2">SetSink2</a>(&amp;m_logPanel.GetByteSink());
<a name="l00501"></a>00501       }
<a name="l00502"></a>00502 
<a name="l00503"></a>00503       <span class="comment">// Let the parent &#39;go first&#39;!</span>
<a name="l00504"></a>00504       <a class="code" href="classMFM_1_1AbstractDriver.html#a87b8b3e6e5affa5f1adad93dfb3209e5">Super::OnceOnly</a>(args);
<a name="l00505"></a>00505 
<a name="l00506"></a>00506       <span class="comment">/*</span>
<a name="l00507"></a>00507 <span class="comment">      if (m_countOfScreenshotsPerRate &gt; 0) {</span>
<a name="l00508"></a>00508 <span class="comment">        m_maxRecordScreenshotPerAEPS = m_recordScreenshotPerAEPS;</span>
<a name="l00509"></a>00509 <span class="comment">        m_recordScreenshotPerAEPS = 1;</span>
<a name="l00510"></a>00510 <span class="comment">        m_countOfScreenshotsAtThisAEPS = 0;</span>
<a name="l00511"></a>00511 <span class="comment">      }</span>
<a name="l00512"></a>00512 <span class="comment">      */</span>
<a name="l00513"></a>00513 
<a name="l00514"></a>00514       <span class="keywordflow">if</span> (!getenv(<span class="stringliteral">&quot;SDL_VIDEO_ALLOW_SCREENSAVER&quot;</span>))          <span class="comment">// If user isn&#39;t already messing with this</span>
<a name="l00515"></a>00515         putenv((<span class="keywordtype">char</span> *) <span class="stringliteral">&quot;SDL_VIDEO_ALLOW_SCREENSAVER=1&quot;</span>);  <span class="comment">// Old school sdl 1.2 mechanism</span>
<a name="l00516"></a>00516 
<a name="l00517"></a>00517       SDL_Init(SDL_INIT_EVERYTHING);
<a name="l00518"></a>00518       TTF_Init();
<a name="l00519"></a>00519 
<a name="l00520"></a>00520       SetScreenSize(m_screenWidth, m_screenHeight);
<a name="l00521"></a>00521 
<a name="l00522"></a>00522       m_rootPanel.SetName(<span class="stringliteral">&quot;Root&quot;</span>);
<a name="l00523"></a>00523       m_gridPanel.SetBorder(Drawing::BLACK);
<a name="l00524"></a>00524       m_gridPanel.SetGridRenderer(&amp;m_grend);
<a name="l00525"></a>00525       m_gridPanel.SetToolboxPanel(&amp;m_toolboxPanel);
<a name="l00526"></a>00526       m_gridPanel.SetGrid(&amp;Super::GetGrid());
<a name="l00527"></a>00527 
<a name="l00528"></a>00528       m_statisticsPanel.SetStatsRenderer(&amp;m_srend);
<a name="l00529"></a>00529       m_statisticsPanel.SetGrid(&amp;Super::GetGrid());
<a name="l00530"></a>00530       m_statisticsPanel.SetAEPS(Super::GetAEPS());
<a name="l00531"></a>00531       m_statisticsPanel.SetAER(Super::GetRecentAER());
<a name="l00532"></a>00532       m_statisticsPanel.SetAEPSPerFrame(Super::GetAEPSPerFrame());
<a name="l00533"></a>00533       m_statisticsPanel.SetOverheadPercent(Super::GetOverheadPercent());
<a name="l00534"></a>00534       m_statisticsPanel.SetVisibility(<span class="keyword">false</span>);
<a name="l00535"></a>00535 
<a name="l00536"></a>00536       m_rootPanel.Insert(&amp;m_gridPanel, NULL);
<a name="l00537"></a>00537       m_gridPanel.Insert(&amp;m_statisticsPanel, NULL);
<a name="l00538"></a>00538       m_statisticsPanel.Insert(&amp;m_buttonPanel, NULL);
<a name="l00539"></a>00539       m_buttonPanel.SetVisibility(<span class="keyword">true</span>);
<a name="l00540"></a>00540 
<a name="l00541"></a>00541       m_gridPanel.Insert(&amp;m_logPanel, NULL);
<a name="l00542"></a>00542       m_logPanel.SetVisibility(<span class="keyword">false</span>);
<a name="l00543"></a>00543       m_logPanel.SetDimensions(m_screenWidth, 160);
<a name="l00544"></a>00544       m_logPanel.SetDesiredSize(<a class="code" href="itype_8h.html#a4028a1a55fd7b907a44c48d5ca42d6a6">U32_MAX</a>, 160);
<a name="l00545"></a>00545       m_logPanel.<a class="code" href="classMFM_1_1Panel.html#ac65fa7722ecb55d5b03d3290acddc76c">SetAnchor</a>(ANCHOR_SOUTH);
<a name="l00546"></a>00546       m_logPanel.<a class="code" href="classMFM_1_1Panel.html#a8f13921f8a0a28e79f6e49f13500dc0c">SetFont</a>(AssetManager::Get(FONT_ASSET_LOGGER));
<a name="l00547"></a>00547 
<a name="l00548"></a>00548       m_toolboxPanel.SetName(<span class="stringliteral">&quot;Toolbox&quot;</span>);
<a name="l00549"></a>00549       m_toolboxPanel.SetVisibility(<span class="keyword">false</span>);
<a name="l00550"></a>00550       m_toolboxPanel.SetBackground(Drawing::GREY60);
<a name="l00551"></a>00551       m_toolboxPanel.SetAnchor(ANCHOR_WEST);
<a name="l00552"></a>00552       m_toolboxPanel.SetAnchor(ANCHOR_NORTH);
<a name="l00553"></a>00553       m_gridPanel.Insert(&amp;m_toolboxPanel, NULL);
<a name="l00554"></a>00554       m_toolboxPanel.RebuildControllers();
<a name="l00555"></a>00555 
<a name="l00556"></a>00556       m_helpPanel.SetName(<span class="stringliteral">&quot;Help&quot;</span>);
<a name="l00557"></a>00557       m_helpPanel.SetDimensions(m_screenWidth / 3, m_screenHeight);
<a name="l00558"></a>00558       m_helpPanel.<a class="code" href="classMFM_1_1Panel.html#ac65fa7722ecb55d5b03d3290acddc76c">SetAnchor</a>(ANCHOR_WEST);
<a name="l00559"></a>00559       m_gridPanel.Insert(&amp;m_helpPanel, NULL);
<a name="l00560"></a>00560 
<a name="l00561"></a>00561       m_rootPanel.Print(STDOUT);
<a name="l00562"></a>00562 
<a name="l00563"></a>00563       m_srend.OnceOnly();
<a name="l00564"></a>00564 
<a name="l00565"></a>00565       SDL_WM_SetCaption(<a class="code" href="namespaceMFM.html#ac44e4d0bf4a5aac27913ddd85bab00f2">MFM_VERSION_STRING_LONG</a>, NULL);
<a name="l00566"></a>00566 
<a name="l00567"></a>00567       m_ticksLastStopped = 0;
<a name="l00568"></a>00568 
<a name="l00569"></a>00569       m_reinitRequested = <span class="keyword">false</span>;
<a name="l00570"></a>00570 
<a name="l00571"></a>00571       OnceOnlyButtons();
<a name="l00572"></a>00572 
<a name="l00573"></a>00573       <span class="comment">// Again to &#39;set&#39; stuff?</span>
<a name="l00574"></a>00574       SetScreenSize(m_screenWidth, m_screenHeight);
<a name="l00575"></a>00575     }
<a name="l00576"></a>00576 
<a name="l00577"></a>00577   <span class="keyword">private</span>:
<a name="l00578"></a>00578 
<a name="l00579"></a>00579     <span class="keywordtype">void</span> OnceOnlyButtons()
<a name="l00580"></a>00580     {
<a name="l00581"></a>00581       m_statisticsPanel.<a class="code" href="classMFM_1_1Panel.html#ac65fa7722ecb55d5b03d3290acddc76c">SetAnchor</a>(ANCHOR_EAST);
<a name="l00582"></a>00582 
<a name="l00583"></a>00583       m_buttonPanel.InsertCheckbox(&amp;m_heatmapButton);
<a name="l00584"></a>00584       m_buttonPanel.InsertCheckbox(&amp;m_gridRenderButton);
<a name="l00585"></a>00585       m_buttonPanel.InsertCheckbox(&amp;m_gridRunButton);
<a name="l00586"></a>00586       m_buttonPanel.InsertCheckbox(&amp;m_bgrButton);
<a name="l00587"></a>00587 
<a name="l00588"></a>00588       m_buttonPanel.InsertButton(&amp;m_gridStepButton);
<a name="l00589"></a>00589       m_buttonPanel.InsertButton(&amp;m_clearButton);
<a name="l00590"></a>00590       m_buttonPanel.InsertButton(&amp;m_clearGridButton);
<a name="l00591"></a>00591       m_buttonPanel.InsertButton(&amp;m_xrayButton);
<a name="l00592"></a>00592       m_buttonPanel.InsertButton(&amp;m_nukeButton);
<a name="l00593"></a>00593       m_buttonPanel.InsertButton(&amp;m_tileViewButton);
<a name="l00594"></a>00594       m_buttonPanel.InsertButton(&amp;m_pauseTileButton);
<a name="l00595"></a>00595       m_buttonPanel.InsertButton(&amp;m_saveButton);
<a name="l00596"></a>00596       m_buttonPanel.InsertButton(&amp;m_screenshotButton);
<a name="l00597"></a>00597       m_buttonPanel.InsertButton(&amp;m_reloadButton);
<a name="l00598"></a>00598       m_buttonPanel.InsertButton(&amp;m_quitButton);
<a name="l00599"></a>00599 
<a name="l00600"></a>00600       m_screenshotButton.SetDriver(<span class="keyword">this</span>);
<a name="l00601"></a>00601       m_screenshotButton.SetScreen(screen);
<a name="l00602"></a>00602       m_screenshotButton.SetCamera(&amp;camera);
<a name="l00603"></a>00603 
<a name="l00604"></a>00604       m_pauseTileButton.SetGridRenderer(m_grend);
<a name="l00605"></a>00605 
<a name="l00606"></a>00606       m_gridRenderButton.<a class="code" href="classMFM_1_1AbstractCheckboxExternal.html#ae1f5aa3c4c90e3a686788fc8e4f9b407">SetExternalValue</a>(m_grend.GetGridEnabledPointer());
<a name="l00607"></a>00607       m_heatmapButton.<a class="code" href="classMFM_1_1AbstractCheckboxExternal.html#ae1f5aa3c4c90e3a686788fc8e4f9b407">SetExternalValue</a>(m_grend.GetDrawDataHeatPointer());
<a name="l00608"></a>00608       m_bgrButton.<a class="code" href="classMFM_1_1AbstractCheckboxExternal.html#ae1f5aa3c4c90e3a686788fc8e4f9b407">SetExternalValue</a>(<a class="code" href="classMFM_1_1AbstractDriver.html">AbstractDriver&lt;GC&gt;::GetGrid</a>().
<a name="l00609"></a>00609                                    GetBackgroundRadiationEnabledPointer());
<a name="l00610"></a>00610       m_gridRunButton.<a class="code" href="classMFM_1_1AbstractCheckboxExternal.html#ae1f5aa3c4c90e3a686788fc8e4f9b407">SetExternalValue</a>(&amp;m_keyboardPaused);
<a name="l00611"></a>00611 
<a name="l00612"></a>00612       m_buttonPanel.SetButtonDrivers(*<span class="keyword">this</span>);
<a name="l00613"></a>00613       m_buttonPanel.InsertButtons();
<a name="l00614"></a>00614 
<a name="l00615"></a>00615       m_buttonPanel.<a class="code" href="classMFM_1_1Panel.html#ac65fa7722ecb55d5b03d3290acddc76c">SetAnchor</a>(ANCHOR_SOUTH);
<a name="l00616"></a>00616       m_buttonPanel.<a class="code" href="classMFM_1_1Panel.html#ac65fa7722ecb55d5b03d3290acddc76c">SetAnchor</a>(ANCHOR_EAST);
<a name="l00617"></a>00617     }
<a name="l00618"></a>00618 
<a name="l00619"></a>00619     <span class="keywordtype">void</span> Update(<a class="code" href="classMFM_1_1AbstractGUIDriver.html#aaaa07f2be399bd15e73d95d0aa64834e">OurGrid</a>&amp; grid)
<a name="l00620"></a>00620     {
<a name="l00621"></a>00621       KeyboardUpdate(grid);
<a name="l00622"></a>00622 
<a name="l00623"></a>00623       <span class="keywordflow">if</span> (m_singleStep)
<a name="l00624"></a>00624       {
<a name="l00625"></a>00625         m_keyboardPaused = <span class="keyword">false</span>;
<a name="l00626"></a>00626       }
<a name="l00627"></a>00627 
<a name="l00628"></a>00628       m_gridPaused = m_keyboardPaused || m_mousePaused;
<a name="l00629"></a>00629       <span class="keywordflow">if</span> (!m_gridPaused)
<a name="l00630"></a>00630       {
<a name="l00631"></a>00631         <a class="code" href="classMFM_1_1AbstractDriver.html#a95b57d976d01e253c99f45b21f05773b">Super::UpdateGrid</a>(grid);
<a name="l00632"></a>00632         <span class="keywordflow">if</span> (m_singleStep)
<a name="l00633"></a>00633         {
<a name="l00634"></a>00634           m_keyboardPaused = <span class="keyword">true</span>;
<a name="l00635"></a>00635           m_singleStep = <span class="keyword">false</span>;
<a name="l00636"></a>00636         }
<a name="l00637"></a>00637       }
<a name="l00638"></a>00638       <span class="keywordflow">else</span>
<a name="l00639"></a>00639       {
<a name="l00640"></a>00640         <span class="keyword">const</span> <a class="code" href="namespaceMFM.html#af35531c1df0ac4c25ef5937c2c21a78d">s32</a> ONE_THOUSAND = 1000;
<a name="l00641"></a>00641         <span class="keyword">const</span> <a class="code" href="namespaceMFM.html#af35531c1df0ac4c25ef5937c2c21a78d">s32</a> ONE_MILLION = ONE_THOUSAND*ONE_THOUSAND;
<a name="l00642"></a>00642 
<a name="l00643"></a>00643         <a class="code" href="namespaceMFM.html#afec04035913edcbb8a8d521efaad971a">Sleep</a>(0,33*ONE_MILLION); <span class="comment">// 33 ms ~= 30 fps idle</span>
<a name="l00644"></a>00644       }
<a name="l00645"></a>00645     }
<a name="l00646"></a>00646 
<a name="l00647"></a>00647     <span class="keyword">inline</span> <span class="keywordtype">void</span> ToggleStatsView()
<a name="l00648"></a>00648     {
<a name="l00649"></a>00649       m_statisticsPanel.ToggleVisibility();
<a name="l00650"></a>00650       m_grend.SetDimensions(Point&lt;u32&gt;(m_screenWidth - (m_renderStats ? STATS_WINDOW_WIDTH : 0)
<a name="l00651"></a>00651                                        , m_screenHeight));
<a name="l00652"></a>00652     }
<a name="l00653"></a>00653 
<a name="l00654"></a>00654     <span class="keyword">inline</span> <span class="keywordtype">void</span> ToggleLogView()
<a name="l00655"></a>00655     {
<a name="l00656"></a>00656       m_logPanel.ToggleVisibility();
<a name="l00657"></a>00657     }
<a name="l00658"></a>00658 
<a name="l00659"></a>00659     <span class="keyword">inline</span> <span class="keywordtype">void</span> ToggleToolbox()
<a name="l00660"></a>00660     {
<a name="l00661"></a>00661       m_toolboxPanel.ToggleVisibility();
<a name="l00662"></a>00662       m_gridPanel.SetPaintingEnabled(m_toolboxPanel.IsVisible());
<a name="l00663"></a>00663     }
<a name="l00664"></a>00664 
<a name="l00665"></a>00665     <span class="keywordtype">void</span> KeyboardUpdate(<a class="code" href="classMFM_1_1AbstractGUIDriver.html#aaaa07f2be399bd15e73d95d0aa64834e">OurGrid</a>&amp; grid)
<a name="l00666"></a>00666     {
<a name="l00667"></a>00667       <a class="code" href="namespaceMFM.html#ab8c79d22c49af9b5b1f757ae5d436218">u8</a> speed = m_keyboard.ShiftHeld() ?
<a name="l00668"></a>00668         CAMERA_FAST_SPEED : CAMERA_SLOW_SPEED;
<a name="l00669"></a>00669 
<a name="l00670"></a>00670       <span class="keywordflow">if</span>(m_keyboard.IsDown(SDLK_q) &amp;&amp; m_keyboard.CtrlHeld())
<a name="l00671"></a>00671       {
<a name="l00672"></a>00672         exit(0);
<a name="l00673"></a>00673       }
<a name="l00674"></a>00674 
<a name="l00675"></a>00675       <span class="comment">/* View Control */</span>
<a name="l00676"></a>00676       <span class="keywordflow">if</span>(m_keyboard.SemiAuto(SDLK_a))
<a name="l00677"></a>00677       {
<a name="l00678"></a>00678         m_srend.SetDisplayAER(1 + m_srend.GetDisplayAER());
<a name="l00679"></a>00679       }
<a name="l00680"></a>00680       <span class="keywordflow">if</span>(m_keyboard.SemiAuto(SDLK_i))
<a name="l00681"></a>00681       {
<a name="l00682"></a>00682         ToggleStatsView();
<a name="l00683"></a>00683       }
<a name="l00684"></a>00684       <span class="keywordflow">if</span>(m_keyboard.SemiAuto(SDLK_g))
<a name="l00685"></a>00685       {
<a name="l00686"></a>00686         m_grend.ToggleGrid();
<a name="l00687"></a>00687       }
<a name="l00688"></a>00688       <span class="keywordflow">if</span>(m_keyboard.SemiAuto(SDLK_b))
<a name="l00689"></a>00689       {
<a name="l00690"></a>00690         m_buttonPanel.ToggleVisibility();
<a name="l00691"></a>00691       }
<a name="l00692"></a>00692       <span class="keywordflow">if</span>(m_keyboard.SemiAuto(SDLK_m))
<a name="l00693"></a>00693       {
<a name="l00694"></a>00694         m_grend.ToggleMemDraw();
<a name="l00695"></a>00695       }
<a name="l00696"></a>00696       <span class="keywordflow">if</span>(m_keyboard.SemiAuto(SDLK_k))
<a name="l00697"></a>00697       {
<a name="l00698"></a>00698         m_grend.ToggleDataHeatmap();
<a name="l00699"></a>00699       }
<a name="l00700"></a>00700       <span class="keywordflow">if</span>(m_keyboard.SemiAuto(SDLK_h))
<a name="l00701"></a>00701       {
<a name="l00702"></a>00702         m_helpPanel.ToggleVisibility();
<a name="l00703"></a>00703       }
<a name="l00704"></a>00704       <span class="keywordflow">if</span>(m_keyboard.SemiAuto(SDLK_l))
<a name="l00705"></a>00705       {
<a name="l00706"></a>00706         ToggleLogView();
<a name="l00707"></a>00707       }
<a name="l00708"></a>00708       <span class="keywordflow">if</span>(m_keyboard.SemiAuto(SDLK_p))
<a name="l00709"></a>00709       {
<a name="l00710"></a>00710         m_grend.ToggleTileSeparation();
<a name="l00711"></a>00711       }
<a name="l00712"></a>00712       <span class="keywordflow">if</span>(m_keyboard.SemiAuto(SDLK_v))
<a name="l00713"></a>00713       {
<a name="l00714"></a>00714         m_gridPanel.ToggleAtomViewPanel();
<a name="l00715"></a>00715       }
<a name="l00716"></a>00716 
<a name="l00717"></a>00717       <span class="keywordflow">if</span>(m_keyboard.SemiAuto(SDLK_ESCAPE))
<a name="l00718"></a>00718       {
<a name="l00719"></a>00719         m_gridPanel.DeselectAtomAndTile();
<a name="l00720"></a>00720       }
<a name="l00721"></a>00721 
<a name="l00722"></a>00722       <span class="comment">/* Camera Recording */</span>
<a name="l00723"></a>00723       <span class="keywordflow">if</span>(m_keyboard.SemiAuto(SDLK_r))
<a name="l00724"></a>00724       {
<a name="l00725"></a>00725         m_captureScreenshots = !m_captureScreenshots;
<a name="l00726"></a>00726         <span class="keywordflow">if</span> (m_captureScreenshots)
<a name="l00727"></a>00727           LOG.<a class="code" href="classMFM_1_1Logger.html#af578a4cd8f4b6d51506f978e4596b88d">Message</a>(<span class="stringliteral">&quot;Capturing screenshots every %d AEPS&quot;</span>, this-&gt;GetAEPSPerEpoch());
<a name="l00728"></a>00728         <span class="keywordflow">else</span>
<a name="l00729"></a>00729           LOG.<a class="code" href="classMFM_1_1Logger.html#af578a4cd8f4b6d51506f978e4596b88d">Message</a>(<span class="stringliteral">&quot;Not capturing screenshots&quot;</span>);
<a name="l00730"></a>00730       }
<a name="l00731"></a>00731 
<a name="l00732"></a>00732       <span class="keywordflow">if</span>(m_keyboard.SemiAuto(SDLK_t))
<a name="l00733"></a>00733       {
<a name="l00734"></a>00734         ToggleToolbox();
<a name="l00735"></a>00735       }
<a name="l00736"></a>00736 
<a name="l00737"></a>00737       <span class="comment">/* Camera Movement*/</span>
<a name="l00738"></a>00738       <span class="keywordflow">if</span>(m_keyboard.IsDown(SDLK_LEFT))
<a name="l00739"></a>00739       {
<a name="l00740"></a>00740         m_grend.MoveLeft(speed);
<a name="l00741"></a>00741       }
<a name="l00742"></a>00742       <span class="keywordflow">if</span>(m_keyboard.IsDown(SDLK_DOWN))
<a name="l00743"></a>00743       {
<a name="l00744"></a>00744         m_grend.MoveDown(speed);
<a name="l00745"></a>00745       }
<a name="l00746"></a>00746       <span class="keywordflow">if</span>(m_keyboard.IsDown(SDLK_UP))
<a name="l00747"></a>00747       {
<a name="l00748"></a>00748         m_grend.MoveUp(speed);
<a name="l00749"></a>00749       }
<a name="l00750"></a>00750       <span class="keywordflow">if</span>(m_keyboard.IsDown(SDLK_RIGHT))
<a name="l00751"></a>00751       {
<a name="l00752"></a>00752         m_grend.MoveRight(speed);
<a name="l00753"></a>00753       }
<a name="l00754"></a>00754 
<a name="l00755"></a>00755       <span class="comment">/* Speed Control */</span>
<a name="l00756"></a>00756       <span class="keywordflow">if</span>(m_keyboard.SemiAuto(SDLK_SPACE))
<a name="l00757"></a>00757       {
<a name="l00758"></a>00758         m_keyboardPaused = !m_keyboardPaused;
<a name="l00759"></a>00759       }
<a name="l00760"></a>00760       <span class="keywordflow">if</span>(m_keyboard.SemiAuto(SDLK_s))
<a name="l00761"></a>00761       {
<a name="l00762"></a>00762         m_singleStep = <span class="keyword">true</span>;
<a name="l00763"></a>00763         m_keyboardPaused = <span class="keyword">false</span>;
<a name="l00764"></a>00764       }
<a name="l00765"></a>00765       <span class="keywordflow">if</span>(m_keyboard.IsDown(SDLK_COMMA))
<a name="l00766"></a>00766       {
<a name="l00767"></a>00767         <a class="code" href="classMFM_1_1AbstractDriver.html#ab95d475397cadc828739f37a20eaf532">Super::DecrementAEPSPerFrame</a>(m_keyboard.CtrlHeld() ? 10 : 1);
<a name="l00768"></a>00768       }
<a name="l00769"></a>00769       <span class="keywordflow">if</span>(m_keyboard.IsDown(SDLK_PERIOD))
<a name="l00770"></a>00770       {
<a name="l00771"></a>00771         <a class="code" href="classMFM_1_1AbstractDriver.html#a36dad8f10aea989fce74763ff897cc83">Super::IncrementAEPSPerFrame</a>(m_keyboard.CtrlHeld() ? 10 : 1);
<a name="l00772"></a>00772       }
<a name="l00773"></a>00773 
<a name="l00774"></a>00774       m_keyboard.Flip();
<a name="l00775"></a>00775     }
<a name="l00776"></a>00776 
<a name="l00777"></a>00777   <span class="keyword">public</span>:
<a name="l00778"></a>00778 
<a name="l00779"></a>00779     <span class="keywordtype">void</span> SaveGridWithNextFilename()
<a name="l00780"></a>00780     {
<a name="l00781"></a>00781         <span class="keyword">const</span> <span class="keywordtype">char</span>* filename =
<a name="l00782"></a>00782           <a class="code" href="classMFM_1_1AbstractDriver.html#a2e913ee9f0b4546194cbc30b70168299">Super::GetSimDirPathTemporary</a>(<span class="stringliteral">&quot;save/%D.mfs&quot;</span>, m_saveStateIndex++);
<a name="l00783"></a>00783         Super::SaveGrid(filename);
<a name="l00784"></a>00784     }
<a name="l00785"></a>00785 
<a name="l00786"></a>00786     <span class="keywordtype">void</span> SaveGridWithConstantFilename(<span class="keyword">const</span> <span class="keywordtype">char</span>* filename)
<a name="l00787"></a>00787     {
<a name="l00788"></a>00788       <span class="keyword">const</span> <span class="keywordtype">char</span>* finalName =
<a name="l00789"></a>00789         <a class="code" href="classMFM_1_1AbstractDriver.html#a2e913ee9f0b4546194cbc30b70168299">Super::GetSimDirPathTemporary</a>(<span class="stringliteral">&quot;%s&quot;</span>, filename);
<a name="l00790"></a>00790       Super::SaveGrid(finalName);
<a name="l00791"></a>00791     }
<a name="l00792"></a>00792 
<a name="l00793"></a>00793     AbstractGUIDriver() :
<a name="l00794"></a>00794       m_startPaused(true),
<a name="l00795"></a>00795       m_thisUpdateIsEpoch(false),
<a name="l00796"></a>00796       m_captureScreenshots(false),
<a name="l00797"></a>00797       m_saveStateIndex(0),
<a name="l00798"></a>00798       m_epochSaveStateIndex(0),
<a name="l00799"></a>00799       m_renderStats(false),
<a name="l00800"></a>00800       m_screenWidth(SCREEN_INITIAL_WIDTH),
<a name="l00801"></a>00801       m_screenHeight(SCREEN_INITIAL_HEIGHT),
<a name="l00802"></a>00802       m_selectedTool(TOOL_SELECTOR),
<a name="l00803"></a>00803       m_toolboxPanel(&amp;m_selectedTool),
<a name="l00804"></a>00804       m_buttonPanel()
<a name="l00805"></a>00805     { }
<a name="l00806"></a>00806 
<a name="l00807"></a>00807     ~AbstractGUIDriver()
<a name="l00808"></a>00808     {
<a name="l00809"></a>00809       <a class="code" href="classMFM_1_1AssetManager.html#a911033ff262e2820c150c43cefe18036">AssetManager::Destroy</a>();
<a name="l00810"></a>00810     }
<a name="l00811"></a>00811 
<a name="l00812"></a>00812     <span class="keyword">virtual</span> <span class="keywordtype">void</span> ReinitUs()
<a name="l00813"></a>00813     {
<a name="l00814"></a>00814       <span class="comment">/*</span>
<a name="l00815"></a>00815 <span class="comment">      m_nextEventCountsAEPS = 0;</span>
<a name="l00816"></a>00816 <span class="comment">      m_nextScreenshotAEPS = 0;</span>
<a name="l00817"></a>00817 <span class="comment">      m_nextTimeBasedDataAEPS = 0;</span>
<a name="l00818"></a>00818 <span class="comment">      */</span>
<a name="l00819"></a>00819     }
<a name="l00820"></a>00820 
<a name="l00821"></a><a class="code" href="classMFM_1_1AbstractGUIDriver.html#ae1997ecd1349f6e76aa318af75296694">00821</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMFM_1_1AbstractGUIDriver.html#ae1997ecd1349f6e76aa318af75296694">PostReinit</a>(<a class="code" href="classMFM_1_1VArguments.html">VArguments</a>&amp; args)
<a name="l00822"></a>00822     {
<a name="l00823"></a>00823       HandleResize();
<a name="l00824"></a>00824 
<a name="l00825"></a>00825       m_renderStats = <span class="keyword">false</span>;
<a name="l00826"></a>00826 
<a name="l00827"></a>00827       m_toolboxPanel.AddButtons();
<a name="l00828"></a>00828     }
<a name="l00829"></a>00829 
<a name="l00830"></a><a class="code" href="classMFM_1_1AbstractGUIDriver.html#a4dd2ceeb2a519b11c61b1eca1fdeb01c">00830</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMFM_1_1AbstractGUIDriver.html#a4dd2ceeb2a519b11c61b1eca1fdeb01c">PostReinitPhysics</a>()
<a name="l00831"></a>00831     {
<a name="l00832"></a>00832       <span class="keywordflow">for</span>(<a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> i = 0; i &lt; AbstractDriver&lt;GC&gt;::m_neededElementCount; i++)
<a name="l00833"></a>00833       {
<a name="l00834"></a>00834         GetStatsRenderer().DisplayStatsForElement(<a class="code" href="classMFM_1_1AbstractDriver.html">AbstractDriver&lt;GC&gt;::GetGrid</a>(),
<a name="l00835"></a>00835                                                   *(<a class="code" href="classMFM_1_1AbstractDriver.html">AbstractDriver&lt;GC&gt;::m_neededElements</a>[i]));
<a name="l00836"></a>00836         this-&gt;RegisterToolboxElement(<a class="code" href="classMFM_1_1AbstractDriver.html">AbstractDriver&lt;GC&gt;::m_neededElements</a>[i]);
<a name="l00837"></a>00837       }
<a name="l00838"></a>00838     }
<a name="l00839"></a>00839 
<a name="l00840"></a>00840     <span class="keyword">virtual</span> <span class="keywordtype">void</span> HandleResize()
<a name="l00841"></a>00841     { }
<a name="l00842"></a>00842 
<a name="l00843"></a>00843     <span class="keywordtype">void</span> ToggleTileView()
<a name="l00844"></a>00844     {
<a name="l00845"></a>00845       m_grend.ToggleMemDraw();
<a name="l00846"></a>00846     }
<a name="l00847"></a>00847 
<a name="l00848"></a>00848     <span class="keywordtype">void</span> RegisterToolboxElement(Element&lt;CC&gt;* element)
<a name="l00849"></a>00849     {
<a name="l00850"></a>00850       m_toolboxPanel.RegisterElement(element);
<a name="l00851"></a>00851     }
<a name="l00852"></a>00852 
<a name="l00853"></a>00853     <span class="comment">/*********************************</span>
<a name="l00854"></a>00854 <span class="comment">     * GUI SPECIFIC DRIVER ARGUMENTS *</span>
<a name="l00855"></a>00855 <span class="comment">     *********************************/</span>
<a name="l00856"></a>00856 
<a name="l00857"></a>00857     <span class="keyword">static</span> <span class="keywordtype">void</span> ConfigStatsOnlyView(<span class="keyword">const</span> <span class="keywordtype">char</span>* not_used, <span class="keywordtype">void</span>* driverptr)
<a name="l00858"></a>00858     {
<a name="l00859"></a>00859       AbstractGUIDriver* driver = (AbstractGUIDriver&lt;GC&gt;*)driverptr;
<a name="l00860"></a>00860 
<a name="l00861"></a>00861 
<a name="l00862"></a>00862       driver-&gt;m_screenWidth = STATS_START_WINDOW_WIDTH;
<a name="l00863"></a>00863       driver-&gt;m_screenHeight = STATS_START_WINDOW_HEIGHT;
<a name="l00864"></a>00864       driver-&gt;ToggleStatsView();
<a name="l00865"></a>00865       driver-&gt;m_srend.SetDisplayAER(driver-&gt;m_srend.GetMaxDisplayAER());
<a name="l00866"></a>00866     }
<a name="l00867"></a>00867 
<a name="l00868"></a>00868     <span class="keyword">static</span> <span class="keywordtype">void</span> ConfigMinimalView(<span class="keyword">const</span> <span class="keywordtype">char</span>* not_used, <span class="keywordtype">void</span>* driverptr)
<a name="l00869"></a>00869     {
<a name="l00870"></a>00870       AbstractGUIDriver* driver = (AbstractGUIDriver&lt;GC&gt;*)driverptr;
<a name="l00871"></a>00871 
<a name="l00872"></a>00872       driver-&gt;m_screenWidth = MINIMAL_START_WINDOW_HEIGHT;
<a name="l00873"></a>00873       driver-&gt;m_screenHeight = MINIMAL_START_WINDOW_WIDTH;
<a name="l00874"></a>00874     }
<a name="l00875"></a>00875 
<a name="l00876"></a>00876     <span class="keyword">static</span> <span class="keywordtype">void</span> SetRecordScreenshotPerAEPSFromArgs(<span class="keyword">const</span> <span class="keywordtype">char</span>* aeps, <span class="keywordtype">void</span>* driverptr)
<a name="l00877"></a>00877     {
<a name="l00878"></a>00878       AbstractGUIDriver* driver = (AbstractGUIDriver&lt;GC&gt;*)driverptr;
<a name="l00879"></a>00879 
<a name="l00880"></a>00880       driver-&gt;m_captureScreenshots = <span class="keyword">true</span>;
<a name="l00881"></a>00881     }
<a name="l00882"></a>00882 
<a name="l00883"></a>00883     <span class="keyword">static</span> <span class="keywordtype">void</span> SetStartPausedFromArgs(<span class="keyword">const</span> <span class="keywordtype">char</span>* not_used, <span class="keywordtype">void</span>* driverptr)
<a name="l00884"></a>00884     {
<a name="l00885"></a>00885       AbstractGUIDriver&amp; driver = *((AbstractGUIDriver*)driverptr);
<a name="l00886"></a>00886 
<a name="l00887"></a>00887       driver.m_startPaused = <span class="keyword">false</span>;
<a name="l00888"></a>00888     }
<a name="l00889"></a>00889 
<a name="l00890"></a>00890     <span class="keyword">static</span> <span class="keywordtype">void</span> DontShowHelpPanelOnStart(<span class="keyword">const</span> <span class="keywordtype">char</span>* not_used, <span class="keywordtype">void</span>* driverptr)
<a name="l00891"></a>00891     {
<a name="l00892"></a>00892       AbstractGUIDriver&amp; driver = *((AbstractGUIDriver*)driverptr);
<a name="l00893"></a>00893 
<a name="l00894"></a>00894       driver.m_helpPanel.SetVisibility(<span class="keyword">false</span>);
<a name="l00895"></a>00895     }
<a name="l00896"></a>00896 
<a name="l00897"></a><a class="code" href="classMFM_1_1AbstractGUIDriver.html#ab25a6dbf2d7103261ec72ebc39edf241">00897</a>     <span class="keywordtype">void</span> <a class="code" href="classMFM_1_1AbstractGUIDriver.html#ab25a6dbf2d7103261ec72ebc39edf241">AddDriverArguments</a>()
<a name="l00898"></a>00898     {
<a name="l00899"></a>00899       <a class="code" href="classMFM_1_1AbstractDriver.html#a166da29ef38b64c93b4a557d43e45bbc">Super::AddDriverArguments</a>();
<a name="l00900"></a>00900 
<a name="l00901"></a>00901       this-&gt;RegisterSection(<span class="stringliteral">&quot;GUI switches&quot;</span>);
<a name="l00902"></a>00902 
<a name="l00903"></a>00903       this-&gt;RegisterArgument(<span class="stringliteral">&quot;Start with only the statistics view on the screen.&quot;</span>,
<a name="l00904"></a>00904                              <span class="stringliteral">&quot;--startwithoutgrid&quot;</span>, &amp;ConfigStatsOnlyView, <span class="keyword">this</span>, <span class="keyword">false</span>);
<a name="l00905"></a>00905 
<a name="l00906"></a>00906       this-&gt;RegisterArgument(<span class="stringliteral">&quot;Start with a minimal-sized window.&quot;</span>,
<a name="l00907"></a>00907                              <span class="stringliteral">&quot;--startminimal&quot;</span>, &amp;ConfigMinimalView, <span class="keyword">this</span>, <span class="keyword">false</span>);
<a name="l00908"></a>00908 
<a name="l00909"></a>00909       this-&gt;RegisterArgument(<span class="stringliteral">&quot;Capture a screenshot every epoch&quot;</span>,
<a name="l00910"></a>00910                              <span class="stringliteral">&quot;-p|--pngs&quot;</span>, &amp;SetRecordScreenshotPerAEPSFromArgs, <span class="keyword">this</span>, <span class="keyword">false</span>);
<a name="l00911"></a>00911 
<a name="l00912"></a>00912       this-&gt;RegisterArgument(<span class="stringliteral">&quot;Simulation begins upon program startup.&quot;</span>,
<a name="l00913"></a>00913                              <span class="stringliteral">&quot;--run&quot;</span>, &amp;SetStartPausedFromArgs, <span class="keyword">this</span>, <span class="keyword">false</span>);
<a name="l00914"></a>00914 
<a name="l00915"></a>00915       this-&gt;RegisterArgument(<span class="stringliteral">&quot;Help panel is not shown upon startup.&quot;</span>,
<a name="l00916"></a>00916                              <span class="stringliteral">&quot;-n| --nohelp&quot;</span>, &amp;DontShowHelpPanelOnStart, <span class="keyword">this</span>, <span class="keyword">false</span>);
<a name="l00917"></a>00917     }
<a name="l00918"></a>00918 
<a name="l00919"></a>00919     EditingTool m_selectedTool;
<a name="l00920"></a>00920 
<a name="l00921"></a>00921     <a class="code" href="classMFM_1_1GridPanel.html">GridPanel&lt;GC&gt;</a> m_gridPanel;
<a name="l00922"></a>00922 
<a name="l00923"></a>00923     <a class="code" href="classMFM_1_1ToolboxPanel.html">ToolboxPanel&lt;CC&gt;</a> m_toolboxPanel;
<a name="l00924"></a>00924 
<a name="l00925"></a><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1StatisticsPanel.html">00925</a>     <span class="keyword">class </span><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1StatisticsPanel.html">StatisticsPanel</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1Panel.html">Panel</a>
<a name="l00926"></a>00926     {
<a name="l00927"></a>00927       <a class="code" href="classMFM_1_1StatsRenderer.html">StatsRenderer&lt;GC&gt;</a>* m_srend;
<a name="l00928"></a>00928       <a class="code" href="classMFM_1_1Grid.html">OurGrid</a>* m_mainGrid;
<a name="l00929"></a>00929       <span class="keywordtype">double</span> m_AEPS;
<a name="l00930"></a>00930       <span class="keywordtype">double</span> m_AER;
<a name="l00931"></a>00931       <span class="keywordtype">double</span> m_overheadPercent;
<a name="l00932"></a>00932       <a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> m_aepsPerFrame;
<a name="l00933"></a>00933 
<a name="l00934"></a>00934      <span class="keyword">public</span>:
<a name="l00935"></a>00935       <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1StatisticsPanel.html">StatisticsPanel</a>() : m_srend(NULL)
<a name="l00936"></a>00936       {
<a name="l00937"></a>00937         SetName(<span class="stringliteral">&quot;Statistics Panel&quot;</span>);
<a name="l00938"></a>00938         SetDimensions(STATS_START_WINDOW_WIDTH,
<a name="l00939"></a>00939                       SCREEN_INITIAL_HEIGHT);
<a name="l00940"></a>00940         SetDesiredSize(STATS_START_WINDOW_WIDTH,
<a name="l00941"></a>00941                       <a class="code" href="itype_8h.html#a4028a1a55fd7b907a44c48d5ca42d6a6">U32_MAX</a>);
<a name="l00942"></a>00942         SetRenderPoint(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(100000, 0));
<a name="l00943"></a>00943         <a class="code" href="classMFM_1_1Panel.html#a8af13f2225b29ed18a60aeb2c641f113">SetForeground</a>(Drawing::WHITE);
<a name="l00944"></a>00944         <a class="code" href="classMFM_1_1Panel.html#a769887940542282b8a2757e4cedadd1c">SetBackground</a>(Drawing::DARK_PURPLE);
<a name="l00945"></a>00945         m_AEPS = m_AER = 0.0;
<a name="l00946"></a>00946         m_aepsPerFrame = 0;
<a name="l00947"></a>00947         m_overheadPercent = 0.0;
<a name="l00948"></a>00948       }
<a name="l00949"></a>00949 
<a name="l00950"></a>00950       <span class="keywordtype">void</span> SetStatsRenderer(<a class="code" href="classMFM_1_1StatsRenderer.html">StatsRenderer&lt;GC&gt;</a>* srend)
<a name="l00951"></a>00951       {
<a name="l00952"></a>00952         m_srend = srend;
<a name="l00953"></a>00953       }
<a name="l00954"></a>00954 
<a name="l00955"></a>00955       <span class="keywordtype">void</span> SetGrid(<a class="code" href="classMFM_1_1Grid.html">OurGrid</a>* mainGrid)
<a name="l00956"></a>00956       {
<a name="l00957"></a>00957         m_mainGrid = mainGrid;
<a name="l00958"></a>00958       }
<a name="l00959"></a>00959 
<a name="l00960"></a>00960       <span class="keywordtype">void</span> SetAEPS(<span class="keywordtype">double</span> aeps)
<a name="l00961"></a>00961       {
<a name="l00962"></a>00962         m_AEPS = aeps;
<a name="l00963"></a>00963       }
<a name="l00964"></a>00964 
<a name="l00965"></a>00965       <span class="keywordtype">void</span> SetAER(<span class="keywordtype">double</span> aer)
<a name="l00966"></a>00966       {
<a name="l00967"></a>00967         m_AER = aer;
<a name="l00968"></a>00968       }
<a name="l00969"></a>00969 
<a name="l00970"></a>00970       <span class="keywordtype">void</span> SetOverheadPercent(<span class="keywordtype">double</span> overheadPercent)
<a name="l00971"></a>00971       {
<a name="l00972"></a>00972         m_overheadPercent = overheadPercent;
<a name="l00973"></a>00973       }
<a name="l00974"></a>00974 
<a name="l00975"></a>00975       <span class="keywordtype">void</span> SetAEPSPerFrame(<a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> apf)
<a name="l00976"></a>00976       {
<a name="l00977"></a>00977         m_aepsPerFrame = apf;
<a name="l00978"></a>00978       }
<a name="l00979"></a>00979 
<a name="l00980"></a>00980     <span class="keyword">protected</span>:
<a name="l00981"></a><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1StatisticsPanel.html#adb4c7c2ef98382ac5fcd8faae483fe98">00981</a>       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1StatisticsPanel.html#adb4c7c2ef98382ac5fcd8faae483fe98">PaintComponent</a>(<a class="code" href="classMFM_1_1Drawing.html">Drawing</a>&amp; drawing)
<a name="l00982"></a>00982       {
<a name="l00983"></a>00983         this-&gt;<a class="code" href="classMFM_1_1AbstractGUIDriver_1_1StatisticsPanel.html#adb4c7c2ef98382ac5fcd8faae483fe98">Panel::PaintComponent</a>(drawing);
<a name="l00984"></a>00984         m_srend-&gt;RenderGridStatistics(drawing, *m_mainGrid,
<a name="l00985"></a>00985                                       m_AEPS, m_AER, m_aepsPerFrame,
<a name="l00986"></a>00986                                       m_overheadPercent, <span class="keyword">false</span>);
<a name="l00987"></a>00987       }
<a name="l00988"></a>00988 
<a name="l00989"></a><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1StatisticsPanel.html#a34375ce2590e1b739cf699be439d3d50">00989</a>       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1StatisticsPanel.html#a34375ce2590e1b739cf699be439d3d50">PaintBorder</a>(<a class="code" href="classMFM_1_1Drawing.html">Drawing</a> &amp; config)
<a name="l00990"></a>00990       { <span class="comment">/* No border please */</span> }
<a name="l00991"></a>00991 
<a name="l00992"></a><a class="code" href="classMFM_1_1AbstractGUIDriver_1_1StatisticsPanel.html#a79cc4f6985c69cf11bcf3714c438d98f">00992</a>       <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classMFM_1_1AbstractGUIDriver_1_1StatisticsPanel.html#a79cc4f6985c69cf11bcf3714c438d98f">Handle</a>(<a class="code" href="structMFM_1_1MouseButtonEvent.html">MouseButtonEvent</a>&amp; mbe)
<a name="l00993"></a>00993       {
<a name="l00994"></a>00994         <span class="keywordflow">return</span> <span class="keyword">true</span>;  <span class="comment">/* Eat the event to keep the grid from taking it */</span>
<a name="l00995"></a>00995       }
<a name="l00996"></a>00996     }m_statisticsPanel;
<a name="l00997"></a>00997 
<a name="l00998"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1ButtonPanel.html">00998</a>     <span class="keyword">struct </span><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1ButtonPanel.html">ButtonPanel</a> : <span class="keyword">public</span> <a class="code" href="classMFM_1_1Panel.html">Panel</a>
<a name="l00999"></a>00999     {
<a name="l01000"></a>01000       <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> MAX_BUTTONS = 16;
<a name="l01001"></a>01001       <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> CHECKBOX_SPACING_HEIGHT = 32;
<a name="l01002"></a>01002       <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> BUTTON_SPACING_HEIGHT = 34;
<a name="l01003"></a>01003       <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> BUTTON_HEIGHT = 30;
<a name="l01004"></a>01004       <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> BUTTON_WIDTH = STATS_START_WINDOW_WIDTH;
<a name="l01005"></a>01005 
<a name="l01006"></a><a class="code" href="structMFM_1_1AbstractGUIDriver_1_1ButtonPanel.html#a6946333905ccde016cadcb7a154a87ea">01006</a>       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1ButtonPanel.html#a6946333905ccde016cadcb7a154a87ea">PaintBorder</a>(<a class="code" href="classMFM_1_1Drawing.html">Drawing</a> &amp; config)
<a name="l01007"></a>01007       { <span class="comment">/* No border please */</span> }
<a name="l01008"></a>01008 
<a name="l01009"></a>01009       <a class="code" href="structMFM_1_1AbstractGUIDriver_1_1ButtonPanel.html">ButtonPanel</a>() :
<a name="l01010"></a>01010         m_checkboxCount(0),
<a name="l01011"></a>01011         m_buttonCount(0)
<a name="l01012"></a>01012       {
<a name="l01013"></a>01013         SetName(<span class="stringliteral">&quot;ButtonPanel&quot;</span>);
<a name="l01014"></a>01014         SetDimensions(STATS_START_WINDOW_WIDTH,
<a name="l01015"></a>01015                       SCREEN_INITIAL_HEIGHT / 2);
<a name="l01016"></a>01016         SetDesiredSize(<a class="code" href="itype_8h.html#a4028a1a55fd7b907a44c48d5ca42d6a6">U32_MAX</a>, SCREEN_INITIAL_HEIGHT / 2);
<a name="l01017"></a>01017         <a class="code" href="classMFM_1_1Panel.html#ac65fa7722ecb55d5b03d3290acddc76c">SetAnchor</a>(ANCHOR_SOUTH);
<a name="l01018"></a>01018         <span class="comment">/*</span>
<a name="l01019"></a>01019 <span class="comment">        SetRenderPoint(SPoint(0,</span>
<a name="l01020"></a>01020 <span class="comment">                              SCREEN_INITIAL_HEIGHT / 2));</span>
<a name="l01021"></a>01021 <span class="comment">        */</span>
<a name="l01022"></a>01022         <a class="code" href="classMFM_1_1Panel.html#a8af13f2225b29ed18a60aeb2c641f113">SetForeground</a>(Drawing::WHITE);
<a name="l01023"></a>01023         <a class="code" href="classMFM_1_1Panel.html#a769887940542282b8a2757e4cedadd1c">SetBackground</a>(Drawing::DARK_PURPLE);
<a name="l01024"></a>01024         <a class="code" href="classMFM_1_1Panel.html#a8f13921f8a0a28e79f6e49f13500dc0c">SetFont</a>(AssetManager::Get(FONT_ASSET_ELEMENT));
<a name="l01025"></a>01025       }
<a name="l01026"></a>01026 
<a name="l01027"></a>01027       <span class="keywordtype">void</span> InsertCheckbox(AbstractGridCheckbox* checkbox)
<a name="l01028"></a>01028       {
<a name="l01029"></a>01029         <span class="keywordflow">if</span>(m_checkboxCount &gt;= MAX_BUTTONS)
<a name="l01030"></a>01030         {
<a name="l01031"></a>01031           FAIL(OUT_OF_ROOM);
<a name="l01032"></a>01032         }
<a name="l01033"></a>01033 
<a name="l01034"></a>01034         m_checkboxes[m_checkboxCount++] = checkbox;
<a name="l01035"></a>01035 
<a name="l01036"></a>01036         Pack();
<a name="l01037"></a>01037       }
<a name="l01038"></a>01038 
<a name="l01039"></a>01039       <span class="keywordtype">void</span> InsertButton(AbstractGridButton* button)
<a name="l01040"></a>01040       {
<a name="l01041"></a>01041         <span class="keywordflow">if</span>(m_buttonCount &gt;= MAX_BUTTONS)
<a name="l01042"></a>01042         {
<a name="l01043"></a>01043           FAIL(OUT_OF_ROOM);
<a name="l01044"></a>01044         }
<a name="l01045"></a>01045 
<a name="l01046"></a>01046         m_buttons[m_buttonCount++] = button;
<a name="l01047"></a>01047 
<a name="l01048"></a>01048         Pack();
<a name="l01049"></a>01049       }
<a name="l01050"></a>01050 
<a name="l01051"></a>01051       <span class="keywordtype">void</span> SetButtonDrivers(AbstractGUIDriver&amp; driver)
<a name="l01052"></a>01052       {
<a name="l01053"></a>01053         <span class="keywordflow">for</span>(<a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> i = 0; i &lt; m_checkboxCount; i++)
<a name="l01054"></a>01054         {
<a name="l01055"></a>01055           m_checkboxes[i]-&gt;SetDriver(driver);
<a name="l01056"></a>01056         }
<a name="l01057"></a>01057 
<a name="l01058"></a>01058         <span class="keywordflow">for</span>(<a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> i = 0; i &lt; m_buttonCount; i++)
<a name="l01059"></a>01059         {
<a name="l01060"></a>01060           m_buttons[i]-&gt;SetDriver(driver);
<a name="l01061"></a>01061         }
<a name="l01062"></a>01062       }
<a name="l01063"></a>01063 
<a name="l01064"></a>01064       <span class="keywordtype">void</span> InsertButtons()
<a name="l01065"></a>01065       {
<a name="l01066"></a>01066         <span class="keywordflow">for</span>(<a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> i = 0; i &lt; m_checkboxCount; i++)
<a name="l01067"></a>01067         {
<a name="l01068"></a>01068           Panel::Insert(m_checkboxes[i], NULL);
<a name="l01069"></a>01069         }
<a name="l01070"></a>01070 
<a name="l01071"></a>01071         <span class="keywordflow">for</span>(<a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> i = 0; i &lt; m_buttonCount; i++)
<a name="l01072"></a>01072         {
<a name="l01073"></a>01073           Panel::Insert(m_buttons[i], NULL);
<a name="l01074"></a>01074           m_buttons[i]-&gt;<a class="code" href="classMFM_1_1AbstractButton.html#a00474ab1a7b0ed391121b502c3e976f4">SetDimensions</a>(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(BUTTON_WIDTH, BUTTON_HEIGHT));
<a name="l01075"></a>01075         }
<a name="l01076"></a>01076       }
<a name="l01077"></a>01077 
<a name="l01078"></a>01078      <span class="keyword">private</span>:
<a name="l01079"></a>01079       AbstractGridCheckbox* m_checkboxes[MAX_BUTTONS];
<a name="l01080"></a>01080       AbstractGridButton*   m_buttons[MAX_BUTTONS];
<a name="l01081"></a>01081 
<a name="l01082"></a>01082       <a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> m_checkboxCount;
<a name="l01083"></a>01083       <a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> m_buttonCount;
<a name="l01084"></a>01084 
<a name="l01085"></a>01085       <span class="keywordtype">void</span> Pack()
<a name="l01086"></a>01086       {
<a name="l01087"></a>01087         <span class="keywordflow">for</span>(<a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> i = 0; i &lt; m_checkboxCount; i++)
<a name="l01088"></a>01088         {
<a name="l01089"></a>01089           m_checkboxes[i]-&gt;SetRenderPoint(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(2, i * CHECKBOX_SPACING_HEIGHT));
<a name="l01090"></a>01090         }
<a name="l01091"></a>01091 
<a name="l01092"></a>01092         <span class="keywordflow">for</span>(<a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> i = 0; i &lt; m_buttonCount; i++)
<a name="l01093"></a>01093         {
<a name="l01094"></a>01094           m_buttons[i]-&gt;SetRenderPoint(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(2, m_checkboxCount * CHECKBOX_SPACING_HEIGHT +
<a name="l01095"></a>01095                                                  i * BUTTON_SPACING_HEIGHT));
<a name="l01096"></a>01096         }
<a name="l01097"></a>01097 
<a name="l01098"></a>01098         Panel::SetDimensions(STATS_WINDOW_WIDTH,
<a name="l01099"></a>01099                              m_checkboxCount * CHECKBOX_SPACING_HEIGHT +
<a name="l01100"></a>01100                              m_buttonCount * BUTTON_SPACING_HEIGHT);
<a name="l01101"></a>01101       }
<a name="l01102"></a>01102 
<a name="l01103"></a>01103     }m_buttonPanel;
<a name="l01104"></a>01104 
<a name="l01105"></a>01105     TextPanel&lt;120,100&gt; m_logPanel;  <span class="comment">// 120 for timestamp and 96 BPA..</span>
<a name="l01106"></a>01106     TeeByteSink m_logSplitter;
<a name="l01107"></a>01107 
<a name="l01108"></a>01108     <span class="keywordtype">void</span> SetScreenSize(<a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> width, <a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> height)
<a name="l01109"></a>01109     {
<a name="l01110"></a>01110       m_screenWidth = width;
<a name="l01111"></a>01111       m_screenHeight = height;
<a name="l01112"></a>01112       screen = SDL_SetVideoMode(m_screenWidth, m_screenHeight, 32,
<a name="l01113"></a>01113                                 SDL_SWSURFACE | SDL_RESIZABLE);
<a name="l01114"></a>01114 
<a name="l01115"></a>01115       <a class="code" href="classMFM_1_1AssetManager.html#ad041c8c8c34a1d78375d5e477d8b855e">AssetManager::Initialize</a>();
<a name="l01116"></a>01116 
<a name="l01117"></a>01117       <span class="keywordflow">if</span> (screen == 0)
<a name="l01118"></a>01118       {
<a name="l01119"></a>01119         FAIL(ILLEGAL_STATE);
<a name="l01120"></a>01120       }
<a name="l01121"></a>01121 
<a name="l01122"></a>01122       <a class="code" href="namespaceMFM.html#ad6d1104084fba95127f76acb0f30d303">UPoint</a> newDimensions(width, height);
<a name="l01123"></a>01123 
<a name="l01124"></a>01124       m_rootPanel.SetDimensions(m_screenWidth, m_screenHeight);
<a name="l01125"></a>01125       m_gridPanel.SetDimensions(m_screenWidth, m_screenHeight);
<a name="l01126"></a>01126 
<a name="l01127"></a>01127       m_rootPanel.SetRenderPoint(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(0, 0));
<a name="l01128"></a>01128       m_rootPanel.<a class="code" href="classMFM_1_1Panel.html#a8af13f2225b29ed18a60aeb2c641f113">SetForeground</a>(Drawing::BLUE);
<a name="l01129"></a>01129       m_rootPanel.<a class="code" href="classMFM_1_1Panel.html#a769887940542282b8a2757e4cedadd1c">SetBackground</a>(Drawing::RED);
<a name="l01130"></a>01130       m_rootPanel.<a class="code" href="classMFM_1_1Panel.html#a0252994e6042441a7db365d26908163c">HandleResize</a>(newDimensions);
<a name="l01131"></a>01131 
<a name="l01132"></a>01132       m_rootDrawing.<a class="code" href="classMFM_1_1Drawing.html#a0021808abbf7fa46ea79dfcf921088b7">Reset</a>(screen, AssetManager::Get(FONT_ASSET_ELEMENT));
<a name="l01133"></a>01133 
<a name="l01134"></a>01134       <span class="keywordflow">if</span>(m_renderStats)
<a name="l01135"></a>01135       {
<a name="l01136"></a>01136         m_grend.SetDimensions(<a class="code" href="namespaceMFM.html#ad6d1104084fba95127f76acb0f30d303">UPoint</a>(m_screenWidth - STATS_WINDOW_WIDTH,m_screenHeight));
<a name="l01137"></a>01137       }
<a name="l01138"></a>01138       <span class="keywordflow">else</span>
<a name="l01139"></a>01139       {
<a name="l01140"></a>01140         m_grend.SetDimensions(<a class="code" href="namespaceMFM.html#ad6d1104084fba95127f76acb0f30d303">UPoint</a>(m_screenWidth,m_screenHeight));
<a name="l01141"></a>01141       }
<a name="l01142"></a>01142 
<a name="l01143"></a>01143       m_srend.SetDrawPoint(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(0,0));
<a name="l01144"></a>01144       m_srend.SetDimensions(<a class="code" href="namespaceMFM.html#ad6d1104084fba95127f76acb0f30d303">UPoint</a>(STATS_WINDOW_WIDTH, m_screenHeight));
<a name="l01145"></a>01145 
<a name="l01146"></a>01146       printf(<span class="stringliteral">&quot;Screen resize: %d x %d\n&quot;</span>, width, height);
<a name="l01147"></a>01147       HandleResize();
<a name="l01148"></a>01148     }
<a name="l01149"></a>01149 
<a name="l01150"></a>01150     StatsRenderer&lt;GC&gt; &amp; GetStatsRenderer()
<a name="l01151"></a>01151     {
<a name="l01152"></a>01152       <span class="keywordflow">return</span> m_srend;
<a name="l01153"></a>01153     }
<a name="l01154"></a>01154 
<a name="l01155"></a><a class="code" href="classMFM_1_1AbstractGUIDriver.html#a98bc9551b26417b8760a1d11c8280277">01155</a>     <span class="keywordtype">void</span> <a class="code" href="classMFM_1_1AbstractGUIDriver.html#a98bc9551b26417b8760a1d11c8280277">RunHelper</a>()
<a name="l01156"></a>01156     {
<a name="l01157"></a>01157       m_keyboardPaused = m_startPaused;
<a name="l01158"></a>01158       m_singleStep = <span class="keyword">false</span>;
<a name="l01159"></a>01159 
<a name="l01160"></a>01160       <span class="keywordtype">bool</span> running = <span class="keyword">true</span>;
<a name="l01161"></a>01161 
<a name="l01162"></a>01162       SDL_Event event;
<a name="l01163"></a>01163       <a class="code" href="namespaceMFM.html#af35531c1df0ac4c25ef5937c2c21a78d">s32</a> lastFrame = SDL_GetTicks();
<a name="l01164"></a>01164 
<a name="l01165"></a>01165       <a class="code" href="namespaceMFM.html#a3ff9b2028ac2e0ecfa490dc8547ea6a3">u32</a> mouseButtonsDown = 0;
<a name="l01166"></a>01166       ButtonPositionArray dragStartPositions;
<a name="l01167"></a>01167 
<a name="l01168"></a>01168       <span class="keywordflow">while</span>(running)
<a name="l01169"></a>01169       {
<a name="l01170"></a>01170         <span class="keywordflow">while</span>(SDL_PollEvent(&amp;event))
<a name="l01171"></a>01171         {
<a name="l01172"></a>01172           <span class="keywordflow">switch</span>(event.type)
<a name="l01173"></a>01173           {
<a name="l01174"></a>01174           <span class="keywordflow">case</span> SDL_VIDEORESIZE:
<a name="l01175"></a>01175             SetScreenSize(event.resize.w, event.resize.h);
<a name="l01176"></a>01176             <span class="keywordflow">break</span>;
<a name="l01177"></a>01177 
<a name="l01178"></a>01178           <span class="keywordflow">case</span> SDL_QUIT:
<a name="l01179"></a>01179             running = <span class="keyword">false</span>;
<a name="l01180"></a>01180             <span class="keywordflow">break</span>;
<a name="l01181"></a>01181 
<a name="l01182"></a>01182           <span class="keywordflow">case</span> SDL_MOUSEBUTTONUP:
<a name="l01183"></a>01183             mouseButtonsDown &amp;= ~(1&lt;&lt;(<span class="keyword">event</span>.button.button));
<a name="l01184"></a>01184             dragStartPositions[<span class="keyword">event</span>.button.button].Set(-1,-1);
<a name="l01185"></a>01185             <span class="keywordflow">goto</span> mousebuttondispatch;
<a name="l01186"></a>01186 
<a name="l01187"></a>01187           <span class="keywordflow">case</span> SDL_MOUSEBUTTONDOWN:
<a name="l01188"></a>01188             mouseButtonsDown |= 1&lt;&lt;(<span class="keyword">event</span>.button.button);
<a name="l01189"></a>01189             dragStartPositions[<span class="keyword">event</span>.button.button].Set(event.button.x,event.button.y);
<a name="l01190"></a>01190             <span class="comment">// FALL THROUGH</span>
<a name="l01191"></a>01191 
<a name="l01192"></a>01192           mousebuttondispatch:
<a name="l01193"></a>01193             {
<a name="l01194"></a>01194               <a class="code" href="structMFM_1_1MouseButtonEvent.html">MouseButtonEvent</a> mbe(m_keyboard, event, m_selectedTool);
<a name="l01195"></a>01195               m_rootPanel.<a class="code" href="classMFM_1_1Panel.html#a3782f4ae4211e2cb05c9485c54e86878">Dispatch</a>(mbe,
<a name="l01196"></a>01196                                    <a class="code" href="classMFM_1_1Rect.html">Rect</a>(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(),
<a name="l01197"></a>01197                                         <a class="code" href="namespaceMFM.html#ad6d1104084fba95127f76acb0f30d303">UPoint</a>(m_screenWidth,m_screenHeight)));
<a name="l01198"></a>01198             }
<a name="l01199"></a>01199             <span class="keywordflow">break</span>;
<a name="l01200"></a>01200 
<a name="l01201"></a>01201           <span class="keywordflow">case</span> SDL_MOUSEMOTION:
<a name="l01202"></a>01202           {
<a name="l01203"></a>01203             <a class="code" href="structMFM_1_1MouseMotionEvent.html">MouseMotionEvent</a> mme(m_keyboard, event,
<a name="l01204"></a>01204                                  mouseButtonsDown, dragStartPositions, m_selectedTool);
<a name="l01205"></a>01205             m_rootPanel.<a class="code" href="classMFM_1_1Panel.html#a3782f4ae4211e2cb05c9485c54e86878">Dispatch</a>(mme,
<a name="l01206"></a>01206                                  <a class="code" href="classMFM_1_1Rect.html">Rect</a>(<a class="code" href="namespaceMFM.html#a7c8c9ccec4fe4047d908ce5eb5e0b1d4">SPoint</a>(),
<a name="l01207"></a>01207                                       <a class="code" href="namespaceMFM.html#ad6d1104084fba95127f76acb0f30d303">UPoint</a>(m_screenWidth,m_screenHeight)));
<a name="l01208"></a>01208           }
<a name="l01209"></a>01209           <span class="keywordflow">break</span>;
<a name="l01210"></a>01210 
<a name="l01211"></a>01211           <span class="keywordflow">case</span> SDL_KEYDOWN:
<a name="l01212"></a>01212           <span class="keywordflow">case</span> SDL_KEYUP:
<a name="l01213"></a>01213             m_keyboard.HandleEvent(&amp;event.key);
<a name="l01214"></a>01214             <span class="keywordflow">break</span>;
<a name="l01215"></a>01215 
<a name="l01216"></a>01216           }
<a name="l01217"></a>01217         }
<a name="l01218"></a>01218 
<a name="l01219"></a>01219         m_mousePaused = mouseButtonsDown != 0;
<a name="l01220"></a>01220 
<a name="l01221"></a>01221         <span class="comment">/* Limit framerate */</span>
<a name="l01222"></a>01222         <a class="code" href="namespaceMFM.html#af35531c1df0ac4c25ef5937c2c21a78d">s32</a> sleepMS = (<a class="code" href="namespaceMFM.html#af35531c1df0ac4c25ef5937c2c21a78d">s32</a>)
<a name="l01223"></a>01223           ((1000.0 / FRAMES_PER_SECOND) -
<a name="l01224"></a>01224            (SDL_GetTicks() - lastFrame));
<a name="l01225"></a>01225         <span class="keywordflow">if</span>(sleepMS &gt; 0)
<a name="l01226"></a>01226         {
<a name="l01227"></a>01227           SDL_Delay(sleepMS);
<a name="l01228"></a>01228         }
<a name="l01229"></a>01229         lastFrame = SDL_GetTicks();
<a name="l01230"></a>01230 
<a name="l01231"></a>01231 
<a name="l01232"></a>01232         m_thisUpdateIsEpoch = <span class="keyword">false</span>;  <span class="comment">// Assume it&#39;s not</span>
<a name="l01233"></a>01233 
<a name="l01234"></a>01234         Update(Super::GetGrid());
<a name="l01235"></a>01235 
<a name="l01236"></a>01236         m_rootDrawing.<a class="code" href="classMFM_1_1Drawing.html#ac6b3f1011924c4ded1b5a583cfee89eb">Clear</a>();
<a name="l01237"></a>01237 
<a name="l01238"></a>01238         m_rootPanel.Paint(m_rootDrawing);
<a name="l01239"></a>01239 
<a name="l01240"></a>01240         <span class="keywordflow">if</span> (m_thisUpdateIsEpoch)
<a name="l01241"></a>01241         {
<a name="l01242"></a>01242           <span class="keywordflow">if</span> (m_captureScreenshots)
<a name="l01243"></a>01243           {
<a name="l01244"></a>01244             <span class="keyword">const</span> <span class="keywordtype">char</span> * path = <a class="code" href="classMFM_1_1AbstractDriver.html#a2e913ee9f0b4546194cbc30b70168299">Super::GetSimDirPathTemporary</a>(<span class="stringliteral">&quot;vid/%010d.png&quot;</span>, m_thisEpochAEPS);
<a name="l01245"></a>01245 
<a name="l01246"></a>01246             camera.DrawSurface(screen,path);
<a name="l01247"></a>01247           }
<a name="l01248"></a>01248           {
<a name="l01249"></a>01249             <span class="comment">/*</span>
<a name="l01250"></a>01250 <span class="comment">            const char * path = Super::GetSimDirPathTemporary(&quot;tbd/data.dat&quot;);</span>
<a name="l01251"></a>01251 <span class="comment">            bool exists = true;</span>
<a name="l01252"></a>01252 <span class="comment">            {</span>
<a name="l01253"></a>01253 <span class="comment">              FILE* fp = fopen(path, &quot;r&quot;);</span>
<a name="l01254"></a>01254 <span class="comment">              if (!fp) exists = false;</span>
<a name="l01255"></a>01255 <span class="comment">              else fclose(fp);</span>
<a name="l01256"></a>01256 <span class="comment">            }</span>
<a name="l01257"></a>01257 <span class="comment">            FILE* fp = fopen(path, &quot;a&quot;);</span>
<a name="l01258"></a>01258 <span class="comment">            FileByteSink fbs(fp);</span>
<a name="l01259"></a>01259 <span class="comment">            m_srend.WriteRegisteredCounts(fbs, !exists, Super::GetGrid(),</span>
<a name="l01260"></a>01260 <span class="comment">                                          Super::GetAEPS(),</span>
<a name="l01261"></a>01261 <span class="comment">                                          Super::GetAER(),</span>
<a name="l01262"></a>01262 <span class="comment">                                          Super::GetAEPSPerFrame(),</span>
<a name="l01263"></a>01263 <span class="comment">                                          Super::GetOverheadPercent(), true);</span>
<a name="l01264"></a>01264 <span class="comment">            fclose(fp);</span>
<a name="l01265"></a>01265 <span class="comment">            */</span>
<a name="l01266"></a>01266             <a class="code" href="classMFM_1_1AbstractDriver.html">AbstractDriver&lt;GC&gt;::WriteTimeBasedData</a>();
<a name="l01267"></a>01267           }
<a name="l01268"></a>01268 
<a name="l01269"></a>01269         }
<a name="l01270"></a>01270 
<a name="l01271"></a>01271         <span class="keywordflow">if</span>(Super::GetHaltAfterAEPS() &gt; 0 &amp;&amp;
<a name="l01272"></a>01272            Super::GetAEPS() &gt; Super::GetHaltAfterAEPS())
<a name="l01273"></a>01273         {
<a name="l01274"></a>01274           <span class="comment">// Free final save if --haltafteraeps.  Hope for good-looking corpse</span>
<a name="l01275"></a>01275           SaveGridWithConstantFilename(<span class="stringliteral">&quot;save/final.mfs&quot;</span>);
<a name="l01276"></a>01276           running = <span class="keyword">false</span>;
<a name="l01277"></a>01277         }
<a name="l01278"></a>01278 
<a name="l01279"></a>01279         SDL_Flip(screen);
<a name="l01280"></a>01280       }
<a name="l01281"></a>01281 
<a name="l01282"></a>01282       SDL_FreeSurface(screen);
<a name="l01283"></a>01283       TTF_Quit();
<a name="l01284"></a>01284       SDL_Quit();
<a name="l01285"></a>01285     }
<a name="l01286"></a>01286   };
<a name="l01287"></a>01287 } <span class="comment">/* namespace MFM */</span>
<a name="l01288"></a>01288 
<a name="l01289"></a>01289 <span class="preprocessor">#endif </span><span class="comment">/* ABSTRACTGUIDRIVER_H */</span>
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 2 2014 17:25:17 for MFMv2 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
